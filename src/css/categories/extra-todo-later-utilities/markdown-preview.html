<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Markdown Preview - JaZeR CSS Patterns</title>
    <link rel="stylesheet" href="../../../jazer-brand.css">
    <style>
        /* ==================== BASE STYLES ==================== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-body);
            background: var(--bg-dark);
            color: var(--text-light);
            min-height: 100vh;
            padding: 2rem;
            position: relative;
            overflow-x: hidden;
        }

        /* Animated background */
        body::before {
            content: '';
            position: fixed;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: 
                radial-gradient(circle at 20% 30%, rgba(0, 242, 234, 0.08) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(147, 51, 234, 0.08) 0%, transparent 50%),
                radial-gradient(circle at 50% 50%, rgba(255, 0, 110, 0.05) 0%, transparent 50%);
            animation: backgroundShift 20s ease-in-out infinite;
            z-index: -1;
            pointer-events: none;
        }

        @keyframes backgroundShift {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            33% { transform: translate(-3%, 3%) rotate(1deg); }
            66% { transform: translate(3%, -3%) rotate(-1deg); }
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
        }

        /* ==================== BACK BUTTON ==================== */
        .back-button {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--text-gray);
            text-decoration: none;
            font-family: var(--font-secondary);
            font-weight: 600;
            padding: 0.75rem 1.5rem;
            border-radius: 12px;
            border: 2px solid var(--border-default);
            background: var(--bg-card);
            transition: all 0.3s ease;
            margin-bottom: 2rem;
        }

        .back-button:hover {
            border-color: var(--jazer-cyan);
            color: var(--jazer-cyan);
            transform: translateX(-5px);
            box-shadow: 0 0 20px rgba(0, 242, 234, 0.3);
        }

        /* ==================== HERO SECTION ==================== */
        .hero {
            text-align: center;
            padding: 2.5rem 2rem;
            margin-bottom: 2rem;
            background: linear-gradient(135deg, rgba(6, 182, 212, 0.08) 0%, rgba(147, 51, 234, 0.08) 50%, rgba(236, 72, 153, 0.08) 100%);
            border-radius: 20px;
            border: 2px solid rgba(6, 182, 212, 0.2);
            position: relative;
            overflow: hidden;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--gradient-primary);
        }

        .hero h1 {
            font-family: var(--font-primary);
            font-size: clamp(2rem, 5vw, 3rem);
            font-weight: 800;
            background: var(--gradient-text);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 1rem;
            letter-spacing: -0.02em;
        }

        .hero-description {
            color: var(--text-gray);
            font-size: 1.1rem;
            max-width: 800px;
            margin: 0 auto;
            line-height: 1.6;
        }

        /* ==================== TOOLBAR ==================== */
        .toolbar {
            background: var(--bg-card);
            border: 2px solid var(--border-default);
            border-radius: 16px;
            padding: 1rem 1.5rem;
            margin-bottom: 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .toolbar-group {
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }

        .tool-btn {
            padding: 0.6rem 1rem;
            border-radius: 8px;
            border: 2px solid var(--border-default);
            background: rgba(0, 0, 0, 0.3);
            color: var(--text-gray);
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.813rem;
            font-family: var(--font-secondary);
            font-weight: 600;
            text-transform: uppercase;
        }

        .tool-btn:hover {
            border-color: var(--jazer-cyan);
            color: var(--jazer-cyan);
            background: rgba(0, 242, 234, 0.1);
            transform: translateY(-2px);
        }

        .tool-btn.active {
            border-color: var(--jazer-cyan);
            background: rgba(0, 242, 234, 0.2);
            color: var(--jazer-cyan);
        }

        /* ==================== SPLIT VIEW ==================== */
        .split-view {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .editor-panel, .preview-panel {
            background: var(--bg-card);
            border: 2px solid var(--border-default);
            border-radius: 16px;
            padding: 1.5rem;
            transition: border-color 0.3s ease;
            display: flex;
            flex-direction: column;
        }

        .editor-panel:hover, .preview-panel:hover {
            border-color: var(--jazer-cyan);
        }

        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border-default);
        }

        .panel-header h2 {
            font-family: var(--font-secondary);
            font-size: 1.25rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .editor-panel h2 {
            color: var(--jazer-pink);
        }

        .preview-panel h2 {
            color: var(--jazer-cyan);
        }

        .panel-actions {
            display: flex;
            gap: 0.5rem;
        }

        .icon-btn {
            padding: 0.5rem 0.75rem;
            border-radius: 8px;
            border: 2px solid var(--border-default);
            background: rgba(0, 0, 0, 0.3);
            color: var(--text-gray);
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.75rem;
            font-family: var(--font-secondary);
            font-weight: 600;
            text-transform: uppercase;
        }

        .icon-btn:hover {
            border-color: var(--jazer-cyan);
            color: var(--jazer-cyan);
            background: rgba(0, 242, 234, 0.1);
            transform: translateY(-2px);
        }

        /* ==================== EDITOR ==================== */
        .editor-area {
            flex: 1;
            position: relative;
        }

        .editor-area textarea {
            width: 100%;
            height: 600px;
            padding: 1rem;
            background: rgba(0, 0, 0, 0.4);
            border: 2px solid var(--border-default);
            border-radius: 12px;
            color: var(--text-light);
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.8;
            resize: vertical;
            transition: all 0.2s ease;
        }

        .editor-area textarea:focus {
            outline: none;
            border-color: var(--jazer-cyan);
            box-shadow: 0 0 20px rgba(0, 242, 234, 0.2);
        }

        /* ==================== PREVIEW ==================== */
        .preview-content {
            flex: 1;
            padding: 1.5rem;
            background: rgba(0, 0, 0, 0.4);
            border: 2px solid var(--border-default);
            border-radius: 12px;
            overflow-y: auto;
            height: 600px;
        }

        .preview-content::-webkit-scrollbar {
            width: 8px;
        }

        .preview-content::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 4px;
        }

        .preview-content::-webkit-scrollbar-thumb {
            background: var(--jazer-cyan);
            border-radius: 4px;
        }

        /* Markdown rendered styles */
        .preview-content h1,
        .preview-content h2,
        .preview-content h3,
        .preview-content h4,
        .preview-content h5,
        .preview-content h6 {
            font-family: var(--font-primary);
            color: var(--jazer-cyan);
            margin: 1.5rem 0 1rem;
            line-height: 1.3;
        }

        .preview-content h1 {
            font-size: 2rem;
            border-bottom: 2px solid var(--jazer-cyan);
            padding-bottom: 0.5rem;
        }

        .preview-content h2 {
            font-size: 1.5rem;
            border-bottom: 1px solid var(--border-default);
            padding-bottom: 0.5rem;
        }

        .preview-content h3 { font-size: 1.25rem; }
        .preview-content h4 { font-size: 1.1rem; }

        .preview-content p {
            margin-bottom: 1rem;
            line-height: 1.8;
            color: var(--text-light);
        }

        .preview-content strong {
            color: var(--jazer-purple);
            font-weight: 700;
        }

        .preview-content em {
            color: var(--jazer-pink);
            font-style: italic;
        }

        .preview-content code {
            background: rgba(0, 242, 234, 0.15);
            color: var(--jazer-cyan);
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 0.875rem;
        }

        .preview-content pre {
            background: rgba(0, 0, 0, 0.6);
            border: 1px solid var(--border-default);
            border-left: 3px solid var(--jazer-cyan);
            padding: 1rem;
            border-radius: 8px;
            overflow-x: auto;
            margin: 1rem 0;
        }

        .preview-content pre code {
            background: none;
            padding: 0;
            color: var(--text-light);
        }

        .preview-content blockquote {
            border-left: 4px solid var(--jazer-purple);
            padding-left: 1rem;
            margin: 1rem 0;
            color: var(--text-gray);
            font-style: italic;
            background: rgba(147, 51, 234, 0.1);
            padding: 1rem;
            border-radius: 0 8px 8px 0;
        }

        .preview-content ul, .preview-content ol {
            margin-left: 2rem;
            margin-bottom: 1rem;
        }

        .preview-content li {
            margin-bottom: 0.5rem;
            line-height: 1.6;
        }

        .preview-content a {
            color: var(--jazer-cyan);
            text-decoration: none;
            border-bottom: 1px solid var(--jazer-cyan);
            transition: all 0.2s ease;
        }

        .preview-content a:hover {
            color: var(--jazer-purple);
            border-bottom-color: var(--jazer-purple);
        }

        .preview-content hr {
            border: none;
            border-top: 2px solid var(--border-default);
            margin: 2rem 0;
        }

        .preview-content table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
        }

        .preview-content th,
        .preview-content td {
            border: 1px solid var(--border-default);
            padding: 0.75rem;
            text-align: left;
        }

        .preview-content th {
            background: rgba(0, 242, 234, 0.1);
            color: var(--jazer-cyan);
            font-weight: 700;
        }

        .preview-content img {
            max-width: 100%;
            border-radius: 8px;
            margin: 1rem 0;
        }

        /* ==================== CHEAT SHEET ==================== */
        .cheatsheet {
            background: var(--bg-card);
            border: 2px solid var(--border-default);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .cheatsheet-header {
            font-family: var(--font-secondary);
            font-size: 1.1rem;
            color: var(--jazer-yellow);
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border-default);
        }

        .cheatsheet-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1rem;
        }

        .cheat-item {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid var(--border-default);
            border-radius: 8px;
            padding: 0.75rem;
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .cheat-item:hover {
            border-color: var(--jazer-cyan);
            background: rgba(0, 242, 234, 0.05);
            transform: translateY(-2px);
        }

        .cheat-label {
            font-family: var(--font-secondary);
            font-size: 0.75rem;
            color: var(--text-muted);
            font-weight: 600;
            text-transform: uppercase;
            margin-bottom: 0.5rem;
        }

        .cheat-syntax {
            font-family: 'Courier New', monospace;
            font-size: 0.813rem;
            color: var(--jazer-cyan);
            background: rgba(0, 0, 0, 0.4);
            padding: 0.5rem;
            border-radius: 4px;
        }

        /* ==================== STATUS BAR ==================== */
        .status-bar {
            background: var(--bg-card);
            border: 2px solid var(--border-default);
            border-radius: 12px;
            padding: 1rem 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .status-info {
            display: flex;
            gap: 2rem;
            flex-wrap: wrap;
        }

        .status-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.813rem;
        }

        .status-item span:first-child {
            color: var(--text-muted);
            font-family: var(--font-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 600;
        }

        .status-item span:last-child {
            color: var(--jazer-cyan);
            font-weight: 700;
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.813rem;
            font-weight: 600;
            color: var(--text-light);
            font-family: var(--font-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .status-dot {
            width: 10px;
            height: 10px;
            background: var(--jazer-cyan);
            border-radius: 50%;
            animation: statusPulse 2s ease-in-out infinite;
        }

        @keyframes statusPulse {
            0%, 100% { 
                opacity: 1;
                box-shadow: 0 0 8px var(--jazer-cyan);
            }
            50% { 
                opacity: 0.5;
                box-shadow: 0 0 16px var(--jazer-cyan);
            }
        }

        /* ==================== RESPONSIVE DESIGN ==================== */
        @media (max-width: 1200px) {
            .split-view {
                grid-template-columns: 1fr;
            }

            .cheatsheet {
                display: none;
            }
        }

        @media (max-width: 899px) {
            body {
                padding: 1rem;
            }

            .hero {
                padding: 1.5rem 1rem;
            }

            .hero h1 {
                font-size: 1.75rem;
            }

            .toolbar {
                flex-direction: column;
            }

            .toolbar-group {
                width: 100%;
                justify-content: stretch;
            }

            .tool-btn {
                flex: 1;
            }

            .status-bar {
                flex-direction: column;
                align-items: flex-start;
            }

            .cheatsheet-grid {
                grid-template-columns: 1fr;
            }
        }

        /* ==================== ANIMATIONS ==================== */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Back Button -->
        <a href="index.html" class="back-button">← Back to Utilities</a>

        <!-- Hero Section -->
        <header class="hero">
            <h1>Markdown Preview</h1>
            <p class="hero-description">Write and preview Markdown in real-time. Supports headings, lists, code blocks, tables, links, images, and more with live rendering.</p>
        </header>

        <!-- Toolbar -->
        <section class="toolbar">
            <div class="toolbar-group">
                <button class="tool-btn active" onclick="switchView('split')" id="viewSplit">Split View</button>
                <button class="tool-btn" onclick="switchView('editor')" id="viewEditor">Editor Only</button>
                <button class="tool-btn" onclick="switchView('preview')" id="viewPreview">Preview Only</button>
            </div>
            <div class="toolbar-group">
                <button class="tool-btn" onclick="clearEditor()">Clear</button>
                <button class="tool-btn" onclick="loadTemplate()">Template</button>
                <button class="tool-btn" onclick="copyMarkdown()">Copy MD</button>
                <button class="tool-btn" onclick="copyHTML()">Copy HTML</button>
                <button class="tool-btn" onclick="downloadMarkdown()">Download</button>
            </div>
        </section>

        <!-- Split View -->
        <div class="split-view" id="splitView">
            <!-- Editor Panel -->
            <section class="editor-panel" id="editorPanel">
                <div class="panel-header">
                    <h2>Markdown Editor</h2>
                    <div class="panel-actions">
                        <button class="icon-btn" onclick="pasteText()">Paste</button>
                        <button class="icon-btn" onclick="undoEdit()">Undo</button>
                    </div>
                </div>
                <div class="editor-area">
                    <textarea id="markdownInput" placeholder="# Start writing Markdown here..."></textarea>
                </div>
            </section>

            <!-- Preview Panel -->
            <section class="preview-panel" id="previewPanel">
                <div class="panel-header">
                    <h2>Live Preview</h2>
                    <div class="panel-actions">
                        <button class="icon-btn" onclick="refreshPreview()">Refresh</button>
                    </div>
                </div>
                <div class="preview-content" id="previewContent">
                    <p style="color: var(--text-muted); font-style: italic;">Start typing in the editor to see live preview...</p>
                </div>
            </section>
        </div>

        <!-- Cheat Sheet -->
        <section class="cheatsheet">
            <div class="cheatsheet-header">Markdown Syntax Quick Reference</div>
            <div class="cheatsheet-grid">
                <div class="cheat-item" onclick="insertSyntax('# ')">
                    <div class="cheat-label">Heading 1</div>
                    <div class="cheat-syntax"># Heading 1</div>
                </div>
                <div class="cheat-item" onclick="insertSyntax('## ')">
                    <div class="cheat-label">Heading 2</div>
                    <div class="cheat-syntax">## Heading 2</div>
                </div>
                <div class="cheat-item" onclick="insertSyntax('### ')">
                    <div class="cheat-label">Heading 3</div>
                    <div class="cheat-syntax">### Heading 3</div>
                </div>
                <div class="cheat-item" onclick="insertSyntax('**bold**')">
                    <div class="cheat-label">Bold</div>
                    <div class="cheat-syntax">**bold text**</div>
                </div>
                <div class="cheat-item" onclick="insertSyntax('*italic*')">
                    <div class="cheat-label">Italic</div>
                    <div class="cheat-syntax">*italic text*</div>
                </div>
                <div class="cheat-item" onclick="insertSyntax('`code`')">
                    <div class="cheat-label">Inline Code</div>
                    <div class="cheat-syntax">`code`</div>
                </div>
                <div class="cheat-item" onclick="insertSyntax('[link](url)')">
                    <div class="cheat-label">Link</div>
                    <div class="cheat-syntax">[text](url)</div>
                </div>
                <div class="cheat-item" onclick="insertSyntax('- ')">
                    <div class="cheat-label">List Item</div>
                    <div class="cheat-syntax">- list item</div>
                </div>
                <div class="cheat-item" onclick="insertSyntax('> ')">
                    <div class="cheat-label">Blockquote</div>
                    <div class="cheat-syntax">> quote</div>
                </div>
                <div class="cheat-item" onclick="insertSyntax('```\\n\\n```')">
                    <div class="cheat-label">Code Block</div>
                    <div class="cheat-syntax">```language<br>code<br>```</div>
                </div>
                <div class="cheat-item" onclick="insertSyntax('---')">
                    <div class="cheat-label">Horizontal Rule</div>
                    <div class="cheat-syntax">---</div>
                </div>
                <div class="cheat-item" onclick="insertSyntax('![alt](url)')">
                    <div class="cheat-label">Image</div>
                    <div class="cheat-syntax">![alt](url)</div>
                </div>
            </div>
        </section>

        <!-- Status Bar -->
        <footer class="status-bar">
            <div class="status-info">
                <div class="status-item">
                    <span>Characters:</span>
                    <span id="statusChars">0</span>
                </div>
                <div class="status-item">
                    <span>Words:</span>
                    <span id="statusWords">0</span>
                </div>
                <div class="status-item">
                    <span>Lines:</span>
                    <span id="statusLines">0</span>
                </div>
                <div class="status-item">
                    <span>View:</span>
                    <span id="statusView">Split</span>
                </div>
            </div>
            <div class="status-indicator">
                <span class="status-dot"></span>
                <span>Live</span>
            </div>
        </footer>
    </div>

    <script>
        // ==================== DOM REFERENCES ====================
        const markdownInput = document.getElementById('markdownInput');
        const previewContent = document.getElementById('previewContent');
        const splitView = document.getElementById('splitView');
        const editorPanel = document.getElementById('editorPanel');
        const previewPanel = document.getElementById('previewPanel');

        let currentView = 'split';
        let undoStack = [];

        // ==================== MARKDOWN PARSER ====================
        function parseMarkdown(md) {
            let html = md;

            // Escape HTML
            html = html.replace(/&/g, '&amp;')
                       .replace(/</g, '&lt;')
                       .replace(/>/g, '&gt;');

            // Code blocks (must be first)
            html = html.replace(/```(\w+)?\n([\s\S]*?)```/g, (match, lang, code) => {
                return `<pre><code class="language-${lang || 'text'}">${code.trim()}</code></pre>`;
            });

            // Inline code
            html = html.replace(/`([^`]+)`/g, '<code>$1</code>');

            // Headers
            html = html.replace(/^###### (.*$)/gim, '<h6>$1</h6>');
            html = html.replace(/^##### (.*$)/gim, '<h5>$1</h5>');
            html = html.replace(/^#### (.*$)/gim, '<h4>$1</h4>');
            html = html.replace(/^### (.*$)/gim, '<h3>$1</h3>');
            html = html.replace(/^## (.*$)/gim, '<h2>$1</h2>');
            html = html.replace(/^# (.*$)/gim, '<h1>$1</h1>');

            // Bold
            html = html.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
            html = html.replace(/__(.*?)__/g, '<strong>$1</strong>');

            // Italic
            html = html.replace(/\*(.*?)\*/g, '<em>$1</em>');
            html = html.replace(/_(.*?)_/g, '<em>$1</em>');

            // Strikethrough
            html = html.replace(/~~(.*?)~~/g, '<del>$1</del>');

            // Links
            html = html.replace(/\[([^\]]+)\]\(([^)]+)\)/g, '<a href="$2" target="_blank">$1</a>');

            // Images
            html = html.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, '<img src="$2" alt="$1">');

            // Horizontal rules
            html = html.replace(/^---$/gim, '<hr>');
            html = html.replace(/^\*\*\*$/gim, '<hr>');

            // Blockquotes
            html = html.replace(/^> (.*$)/gim, '<blockquote>$1</blockquote>');

            // Unordered lists
            html = html.replace(/^\* (.*$)/gim, '<li>$1</li>');
            html = html.replace(/^- (.*$)/gim, '<li>$1</li>');
            html = html.replace(/^+ (.*$)/gim, '<li>$1</li>');

            // Ordered lists
            html = html.replace(/^\d+\. (.*$)/gim, '<li>$1</li>');

            // Wrap consecutive list items
            html = html.replace(/(<li>.*<\/li>\n?)+/g, match => {
                return '<ul>' + match + '</ul>';
            });

            // Line breaks
            html = html.replace(/  \n/g, '<br>');

            // Paragraphs
            const lines = html.split('\n');
            const processed = [];
            let inBlock = false;

            for (let line of lines) {
                line = line.trim();
                
                if (!line) {
                    if (inBlock) {
                        processed.push('</p>');
                        inBlock = false;
                    }
                    continue;
                }

                if (line.match(/^<(h[1-6]|pre|blockquote|ul|ol|hr|table)/)) {
                    if (inBlock) {
                        processed.push('</p>');
                        inBlock = false;
                    }
                    processed.push(line);
                } else {
                    if (!inBlock) {
                        processed.push('<p>');
                        inBlock = true;
                    }
                    processed.push(line + ' ');
                }
            }

            if (inBlock) {
                processed.push('</p>');
            }

            return processed.join('\n');
        }

        // ==================== UPDATE PREVIEW ====================
        function updatePreview() {
            const markdown = markdownInput.value;
            
            if (!markdown.trim()) {
                previewContent.innerHTML = '<p style="color: var(--text-muted); font-style: italic;">Start typing in the editor to see live preview...</p>';
            } else {
                previewContent.innerHTML = parseMarkdown(markdown);
            }

            updateStatistics();
            
            // Save to localStorage
            localStorage.setItem('markdownContent', markdown);
        }

        function refreshPreview() {
            updatePreview();
            showNotification('Preview refreshed');
        }

        // ==================== VIEW SWITCHING ====================
        function switchView(view) {
            currentView = view;

            // Update button states
            document.querySelectorAll('.tool-btn').forEach(btn => btn.classList.remove('active'));

            if (view === 'split') {
                document.getElementById('viewSplit').classList.add('active');
                splitView.style.gridTemplateColumns = '1fr 1fr';
                editorPanel.style.display = 'flex';
                previewPanel.style.display = 'flex';
                document.getElementById('statusView').textContent = 'Split';
            } else if (view === 'editor') {
                document.getElementById('viewEditor').classList.add('active');
                splitView.style.gridTemplateColumns = '1fr';
                editorPanel.style.display = 'flex';
                previewPanel.style.display = 'none';
                document.getElementById('statusView').textContent = 'Editor';
            } else if (view === 'preview') {
                document.getElementById('viewPreview').classList.add('active');
                splitView.style.gridTemplateColumns = '1fr';
                editorPanel.style.display = 'none';
                previewPanel.style.display = 'flex';
                document.getElementById('statusView').textContent = 'Preview';
            }
        }

        // ==================== EDITOR FUNCTIONS ====================
        function insertSyntax(syntax) {
            const start = markdownInput.selectionStart;
            const end = markdownInput.selectionEnd;
            const text = markdownInput.value;
            const selected = text.substring(start, end);

            let insertion;
            if (syntax.includes('url') || syntax.includes('alt')) {
                insertion = syntax;
            } else if (selected) {
                insertion = syntax.replace(/\*\*|\*|`|__|_/g, '') + selected + syntax.match(/\*\*|\*|`|__|_/g)?.[0] || '';
            } else {
                insertion = syntax;
            }

            markdownInput.value = text.substring(0, start) + insertion + text.substring(end);
            markdownInput.focus();
            markdownInput.selectionStart = markdownInput.selectionEnd = start + insertion.length;

            updatePreview();
            showNotification('Syntax inserted');
        }

        function clearEditor() {
            if (confirm('Clear all content?')) {
                undoStack.push(markdownInput.value);
                markdownInput.value = '';
                updatePreview();
                showNotification('Editor cleared');
            }
        }

        function undoEdit() {
            if (undoStack.length > 0) {
                markdownInput.value = undoStack.pop();
                updatePreview();
                showNotification('Undo successful');
            } else {
                showNotification('Nothing to undo');
            }
        }

        async function pasteText() {
            try {
                const text = await navigator.clipboard.readText();
                undoStack.push(markdownInput.value);
                markdownInput.value = text;
                updatePreview();
                showNotification('Text pasted!');
            } catch (err) {
                console.error('Failed to paste:', err);
            }
        }

        function loadTemplate() {
            const template = `# Project Title

## Description
A brief description of what this project does and who it's for.

## Features
- Feature 1
- Feature 2
- Feature 3

## Installation
\`\`\`bash
npm install project-name
\`\`\`

## Usage
\`\`\`javascript
const project = require('project-name');
project.doSomething();
\`\`\`

## Code Example
Here's a simple example:

\`\`\`javascript
function greet(name) {
    return \`Hello, \${name}!\`;
}

console.log(greet('World'));
\`\`\`

## Documentation
> **Note:** This is a sample template to get you started.

For more information, visit [the documentation](https://example.com).

## Contributing
Pull requests are welcome!

---

**Made with ❤️ by [Your Name]**`;

            undoStack.push(markdownInput.value);
            markdownInput.value = template;
            updatePreview();
            showNotification('Template loaded');
        }

        // ==================== EXPORT FUNCTIONS ====================
        function copyMarkdown() {
            const text = markdownInput.value;
            if (!text) {
                showNotification('Nothing to copy');
                return;
            }

            navigator.clipboard.writeText(text).then(() => {
                showNotification('Markdown copied to clipboard!');
            });
        }

        function copyHTML() {
            const html = previewContent.innerHTML;
            if (!html || html.includes('Start typing')) {
                showNotification('Nothing to copy');
                return;
            }

            navigator.clipboard.writeText(html).then(() => {
                showNotification('HTML copied to clipboard!');
            });
        }

        function downloadMarkdown() {
            const text = markdownInput.value;
            if (!text) {
                showNotification('Nothing to download');
                return;
            }

            const blob = new Blob([text], { type: 'text/markdown' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `document-${Date.now()}.md`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            showNotification('Downloaded successfully!');
        }

        // ==================== STATISTICS ====================
        function updateStatistics() {
            const text = markdownInput.value;
            const chars = text.length;
            const words = text.trim().split(/\s+/).filter(w => w.length > 0).length;
            const lines = text.split('\n').length;

            document.getElementById('statusChars').textContent = chars.toLocaleString();
            document.getElementById('statusWords').textContent = words.toLocaleString();
            document.getElementById('statusLines').textContent = lines.toLocaleString();
        }

        // ==================== NOTIFICATIONS ====================
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 2rem;
                right: 2rem;
                background: rgba(0, 242, 234, 0.95);
                color: var(--bg-dark);
                padding: 1rem 1.5rem;
                border-radius: 12px;
                font-family: var(--font-secondary);
                font-weight: 700;
                font-size: 0.875rem;
                z-index: 10000;
                animation: slideIn 0.3s ease-out;
                box-shadow: 0 10px 30px rgba(0, 242, 234, 0.4);
            `;
            notification.textContent = message;
            document.body.appendChild(notification);

            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease-out';
                setTimeout(() => notification.remove(), 300);
            }, 2000);
        }

        // ==================== KEYBOARD SHORTCUTS ====================
        document.addEventListener('keydown', (e) => {
            // Ctrl + S: Download
            if (e.ctrlKey && e.key === 's') {
                e.preventDefault();
                downloadMarkdown();
            }
            // Ctrl + B: Bold
            else if (e.ctrlKey && e.key === 'b') {
                e.preventDefault();
                insertSyntax('****');
            }
            // Ctrl + I: Italic
            else if (e.ctrlKey && e.key === 'i') {
                e.preventDefault();
                insertSyntax('**');
            }
            // Ctrl + K: Link
            else if (e.ctrlKey && e.key === 'k') {
                e.preventDefault();
                insertSyntax('[text](url)');
            }
            // Ctrl + Z: Undo
            else if (e.ctrlKey && e.key === 'z') {
                e.preventDefault();
                undoEdit();
            }
        });

        // ==================== INITIALIZATION ====================
        document.addEventListener('DOMContentLoaded', () => {
            // Load from localStorage
            const saved = localStorage.getItem('markdownContent');
            if (saved) {
                markdownInput.value = saved;
                updatePreview();
            }

            // Auto-update preview on input
            markdownInput.addEventListener('input', updatePreview);

            // Initial update
            updateStatistics();
        });

        // Add slide animations
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
