<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Infinite Scroll Loader - CSS Pattern</title>
    <link rel="stylesheet" href="../../../jazer-brand.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-body);
            background: var(--bg-dark);
            color: var(--text-light);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Hero Section */
        .hero {
            padding: 4rem 2rem 2rem;
            text-align: center;
            background: linear-gradient(180deg, rgba(147, 51, 234, 0.1) 0%, transparent 100%);
            border-bottom: 1px solid rgba(6, 182, 212, 0.2);
        }

        .back-button {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 2rem;
            color: var(--jazer-cyan);
            text-decoration: none;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .back-button:hover {
            color: var(--jazer-pink);
            transform: translateX(-5px);
        }

        h1 {
            font-family: var(--font-primary);
            font-size: clamp(2rem, 5vw, 3.5rem);
            background: var(--gradient-text);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 1rem;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .subtitle {
            color: rgba(255, 255, 255, 0.7);
            font-size: 1.1rem;
            max-width: 600px;
            margin: 0 auto 2rem;
        }

        /* Controls */
        .controls {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 1rem;
            padding: 1.5rem 2rem;
            background: rgba(0, 0, 0, 0.3);
            border-bottom: 1px solid rgba(6, 182, 212, 0.2);
        }

        .control-group {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .control-group label {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.85rem;
        }

        .control-group select {
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid var(--jazer-cyan);
            color: var(--text-light);
            padding: 0.5rem 1rem;
            border-radius: 6px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .control-group select:hover {
            border-color: var(--jazer-pink);
            box-shadow: 0 0 10px rgba(255, 0, 110, 0.3);
        }

        .reset-btn {
            background: linear-gradient(135deg, var(--jazer-pink), var(--jazer-purple));
            border: none;
            color: white;
            padding: 0.5rem 1.5rem;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .reset-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(255, 0, 110, 0.5);
        }

        /* Info Panel */
        .info-panel {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 2rem;
            padding: 1rem 2rem;
            background: rgba(147, 51, 234, 0.1);
            border-bottom: 1px solid rgba(147, 51, 234, 0.3);
        }

        .info-item {
            text-align: center;
        }

        .info-label {
            font-size: 0.75rem;
            color: rgba(255, 255, 255, 0.5);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 0.25rem;
        }

        .info-value {
            font-family: var(--font-primary);
            font-size: 1.25rem;
            color: var(--jazer-cyan);
            font-weight: bold;
        }

        .info-value.highlight {
            color: var(--jazer-pink);
        }

        .info-value.success {
            color: #00ff88;
        }

        /* Main Container */
        .demo-container {
            max-width: 900px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Feed Header */
        .feed-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 1.5rem;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(6, 182, 212, 0.2);
            border-radius: 12px 12px 0 0;
        }

        .feed-title {
            font-family: var(--font-primary);
            color: var(--jazer-cyan);
            font-size: 1.1rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .feed-filters {
            display: flex;
            gap: 0.5rem;
        }

        .filter-btn {
            background: transparent;
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: rgba(255, 255, 255, 0.6);
            padding: 0.4rem 1rem;
            border-radius: 20px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .filter-btn:hover,
        .filter-btn.active {
            border-color: var(--jazer-cyan);
            color: var(--jazer-cyan);
            background: rgba(6, 182, 212, 0.1);
        }

        /* Feed Container */
        .feed-container {
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(6, 182, 212, 0.2);
            border-top: none;
            border-radius: 0 0 12px 12px;
            min-height: 400px;
        }

        /* Post Card */
        .post-card {
            padding: 1.5rem;
            border-bottom: 1px solid rgba(6, 182, 212, 0.1);
            transition: all 0.3s ease;
            animation: slideIn 0.5s ease forwards;
            opacity: 0;
            transform: translateY(20px);
        }

        .post-card:hover {
            background: rgba(6, 182, 212, 0.05);
        }

        @keyframes slideIn {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .post-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .post-avatar {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2rem;
            flex-shrink: 0;
        }

        .post-meta {
            flex: 1;
        }

        .post-author {
            font-weight: 600;
            color: var(--text-light);
            margin-bottom: 0.25rem;
        }

        .post-author span {
            color: var(--jazer-cyan);
            font-size: 0.85rem;
            margin-left: 0.5rem;
        }

        .post-time {
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.5);
        }

        .post-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 4px;
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .post-badge.new {
            background: rgba(0, 255, 136, 0.2);
            color: #00ff88;
            border: 1px solid rgba(0, 255, 136, 0.3);
        }

        .post-badge.trending {
            background: rgba(255, 0, 110, 0.2);
            color: var(--jazer-pink);
            border: 1px solid rgba(255, 0, 110, 0.3);
        }

        .post-content {
            color: rgba(255, 255, 255, 0.9);
            line-height: 1.6;
            margin-bottom: 1rem;
        }

        .post-image {
            width: 100%;
            height: 200px;
            border-radius: 8px;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            opacity: 0.5;
        }

        .post-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .post-tag {
            background: rgba(147, 51, 234, 0.2);
            color: var(--jazer-purple);
            padding: 0.25rem 0.75rem;
            border-radius: 4px;
            font-size: 0.75rem;
        }

        .post-actions {
            display: flex;
            gap: 1.5rem;
        }

        .post-action {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: rgba(255, 255, 255, 0.5);
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .post-action:hover {
            color: var(--jazer-cyan);
        }

        .post-action.liked {
            color: var(--jazer-pink);
        }

        /* Loader Styles */
        .loader-container {
            padding: 2rem;
            text-align: center;
        }

        /* Spinner Loader */
        .loader-spinner {
            display: inline-block;
            width: 40px;
            height: 40px;
            border: 3px solid rgba(6, 182, 212, 0.2);
            border-top-color: var(--jazer-cyan);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Dots Loader */
        .loader-dots {
            display: inline-flex;
            gap: 8px;
        }

        .loader-dots span {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--jazer-cyan);
            animation: dotPulse 1.4s infinite ease-in-out both;
        }

        .loader-dots span:nth-child(1) { animation-delay: -0.32s; }
        .loader-dots span:nth-child(2) { animation-delay: -0.16s; }
        .loader-dots span:nth-child(3) { animation-delay: 0s; }

        @keyframes dotPulse {
            0%, 80%, 100% {
                transform: scale(0.6);
                opacity: 0.5;
            }
            40% {
                transform: scale(1);
                opacity: 1;
            }
        }

        /* Bars Loader */
        .loader-bars {
            display: inline-flex;
            align-items: flex-end;
            gap: 4px;
            height: 30px;
        }

        .loader-bars span {
            width: 6px;
            background: linear-gradient(180deg, var(--jazer-cyan), var(--jazer-purple));
            border-radius: 3px;
            animation: barGrow 1s infinite ease-in-out;
        }

        .loader-bars span:nth-child(1) { animation-delay: 0s; }
        .loader-bars span:nth-child(2) { animation-delay: 0.1s; }
        .loader-bars span:nth-child(3) { animation-delay: 0.2s; }
        .loader-bars span:nth-child(4) { animation-delay: 0.3s; }
        .loader-bars span:nth-child(5) { animation-delay: 0.4s; }

        @keyframes barGrow {
            0%, 100% { height: 10px; }
            50% { height: 30px; }
        }

        /* Pulse Loader */
        .loader-pulse {
            display: inline-block;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--jazer-cyan);
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% {
                transform: scale(0.8);
                opacity: 1;
            }
            50% {
                transform: scale(1.2);
                opacity: 0.5;
            }
            100% {
                transform: scale(0.8);
                opacity: 1;
            }
        }

        /* Wave Loader */
        .loader-wave {
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }

        .loader-wave span {
            width: 4px;
            height: 20px;
            background: var(--jazer-pink);
            border-radius: 2px;
            animation: wave 1.2s infinite ease-in-out;
        }

        .loader-wave span:nth-child(1) { animation-delay: 0s; }
        .loader-wave span:nth-child(2) { animation-delay: 0.1s; }
        .loader-wave span:nth-child(3) { animation-delay: 0.2s; }
        .loader-wave span:nth-child(4) { animation-delay: 0.3s; }
        .loader-wave span:nth-child(5) { animation-delay: 0.4s; }
        .loader-wave span:nth-child(6) { animation-delay: 0.5s; }
        .loader-wave span:nth-child(7) { animation-delay: 0.4s; }
        .loader-wave span:nth-child(8) { animation-delay: 0.3s; }

        @keyframes wave {
            0%, 100% { transform: scaleY(0.5); }
            50% { transform: scaleY(1.5); }
        }

        /* Orbit Loader */
        .loader-orbit {
            display: inline-block;
            width: 40px;
            height: 40px;
            position: relative;
        }

        .loader-orbit::before,
        .loader-orbit::after {
            content: '';
            position: absolute;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            animation: orbit 1.5s linear infinite;
        }

        .loader-orbit::before {
            background: var(--jazer-cyan);
            top: 0;
            left: 50%;
            transform: translateX(-50%);
        }

        .loader-orbit::after {
            background: var(--jazer-pink);
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            animation-delay: 0.75s;
        }

        @keyframes orbit {
            0% { transform: translateX(-50%) rotate(0deg) translateY(-15px); }
            100% { transform: translateX(-50%) rotate(360deg) translateY(-15px); }
        }

        .loader-text {
            color: rgba(255, 255, 255, 0.5);
            font-size: 0.85rem;
            margin-top: 1rem;
        }

        /* End Message */
        .end-message {
            padding: 3rem 2rem;
            text-align: center;
            border-top: 1px solid rgba(147, 51, 234, 0.3);
        }

        .end-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        .end-title {
            font-family: var(--font-primary);
            color: var(--jazer-purple);
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
        }

        .end-text {
            color: rgba(255, 255, 255, 0.5);
            font-size: 0.9rem;
        }

        /* Scroll Progress */
        .scroll-progress {
            position: fixed;
            top: 0;
            left: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--jazer-cyan), var(--jazer-pink));
            z-index: 1000;
            transition: width 0.1s ease;
        }

        /* Back to Top */
        .back-to-top {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--jazer-cyan), var(--jazer-purple));
            border: none;
            border-radius: 50%;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            z-index: 1000;
            box-shadow: 0 0 20px rgba(6, 182, 212, 0.5);
        }

        .back-to-top.visible {
            opacity: 1;
            visibility: visible;
        }

        .back-to-top:hover {
            transform: translateY(-5px) scale(1.1);
        }

        /* Skeleton Loading */
        .skeleton-card {
            padding: 1.5rem;
            border-bottom: 1px solid rgba(6, 182, 212, 0.1);
        }

        .skeleton {
            background: linear-gradient(90deg, 
                rgba(6, 182, 212, 0.05) 25%, 
                rgba(6, 182, 212, 0.1) 50%, 
                rgba(6, 182, 212, 0.05) 75%
            );
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
            border-radius: 4px;
        }

        @keyframes shimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }

        .skeleton-header {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .skeleton-avatar {
            width: 48px;
            height: 48px;
            border-radius: 50%;
        }

        .skeleton-meta {
            flex: 1;
        }

        .skeleton-name {
            height: 16px;
            width: 150px;
            margin-bottom: 8px;
        }

        .skeleton-time {
            height: 12px;
            width: 100px;
        }

        .skeleton-content {
            height: 60px;
            width: 100%;
            margin-bottom: 1rem;
        }

        .skeleton-actions {
            display: flex;
            gap: 1rem;
        }

        .skeleton-action {
            height: 20px;
            width: 60px;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .hero {
                padding: 3rem 1rem 1.5rem;
            }

            .controls {
                flex-direction: column;
                align-items: stretch;
            }

            .control-group {
                justify-content: space-between;
            }

            .info-panel {
                gap: 1rem;
            }

            .demo-container {
                padding: 1rem;
            }

            .feed-header {
                flex-direction: column;
                gap: 1rem;
                text-align: center;
            }

            .post-card {
                padding: 1rem;
            }

            .post-actions {
                flex-wrap: wrap;
            }

            .back-to-top {
                bottom: 20px;
                right: 20px;
                width: 45px;
                height: 45px;
            }
        }
    </style>
</head>
<body>
    <!-- Scroll Progress -->
    <div class="scroll-progress" id="scrollProgress"></div>

    <!-- Back to Top -->
    <button class="back-to-top" id="backToTop">‚Üë</button>

    <!-- Hero Section -->
    <section class="hero">
        <a href="index.html" class="back-button">‚Üê Back to Scroll & Page Transitions</a>
        <h1>Infinite Scroll Loader</h1>
        <p class="subtitle">Automatically load more content as users scroll. Multiple loader styles, customizable thresholds, and smooth animations.</p>
    </section>

    <!-- Controls -->
    <div class="controls">
        <div class="control-group">
            <label>Loader Style:</label>
            <select id="loaderStyle">
                <option value="spinner">Spinner</option>
                <option value="dots" selected>Dots</option>
                <option value="bars">Bars</option>
                <option value="pulse">Pulse</option>
                <option value="wave">Wave</option>
                <option value="orbit">Orbit</option>
            </select>
        </div>
        <div class="control-group">
            <label>Load Delay:</label>
            <select id="loadDelay">
                <option value="500">500ms</option>
                <option value="1000" selected>1000ms</option>
                <option value="1500">1500ms</option>
                <option value="2000">2000ms</option>
            </select>
        </div>
        <div class="control-group">
            <label>Batch Size:</label>
            <select id="batchSize">
                <option value="3">3 posts</option>
                <option value="5" selected>5 posts</option>
                <option value="10">10 posts</option>
            </select>
        </div>
        <div class="control-group">
            <label>Total Posts:</label>
            <select id="totalPosts">
                <option value="20">20 posts</option>
                <option value="50" selected>50 posts</option>
                <option value="100">100 posts</option>
                <option value="0">Infinite</option>
            </select>
        </div>
        <button class="reset-btn" id="resetBtn">Reset Feed</button>
    </div>

    <!-- Info Panel -->
    <div class="info-panel">
        <div class="info-item">
            <div class="info-label">Posts Loaded</div>
            <div class="info-value" id="postsLoaded">0</div>
        </div>
        <div class="info-item">
            <div class="info-label">Load Events</div>
            <div class="info-value highlight" id="loadEvents">0</div>
        </div>
        <div class="info-item">
            <div class="info-label">Scroll Position</div>
            <div class="info-value" id="scrollPosition">0%</div>
        </div>
        <div class="info-item">
            <div class="info-label">Status</div>
            <div class="info-value success" id="feedStatus">Ready</div>
        </div>
    </div>

    <!-- Demo Container -->
    <div class="demo-container">
        <div class="feed-header">
            <div class="feed-title">Cyber Feed</div>
            <div class="feed-filters">
                <button class="filter-btn active">All</button>
                <button class="filter-btn">Trending</button>
                <button class="filter-btn">New</button>
            </div>
        </div>

        <div class="feed-container" id="feedContainer">
            <!-- Posts will be loaded here -->
        </div>
    </div>

    <script>
        // Post data generators
        const authors = [
            { name: 'CyberNova', handle: '@cybernova', color: '#00f2ea' },
            { name: 'NeonKnight', handle: '@neonknight', color: '#9333ea' },
            { name: 'DataStream', handle: '@datastream', color: '#ff006e' },
            { name: 'QuantumCore', handle: '@quantumcore', color: '#00ff88' },
            { name: 'SynthWave', handle: '@synthwave', color: '#ffc107' },
            { name: 'VoidRunner', handle: '@voidrunner', color: '#06b6d4' },
            { name: 'GlitchMaster', handle: '@glitchmaster', color: '#ec4899' },
            { name: 'HoloTech', handle: '@holotech', color: '#8b5cf6' }
        ];

        const contents = [
            "Just deployed a new neural network that processes data 10x faster. The future of AI is here.",
            "Working on a new cyberpunk UI kit. Neon colors, glowing effects, and smooth animations.",
            "Anyone else excited about the new quantum computing breakthroughs? This changes everything.",
            "Finished building my virtual reality workspace. Productivity has never been higher.",
            "The metaverse is evolving faster than expected. Are you ready for the digital revolution?",
            "Just hit 1 million lines of code in my open source project. Thanks to all contributors!",
            "New blog post: 'Building Scalable Systems in the Age of AI'. Link in bio.",
            "Late night coding session. Coffee, synthwave music, and clean architecture.",
            "Exploring the intersection of art and technology. The results are mind-blowing.",
            "Blockchain integration complete. Decentralized future is now.",
            "Machine learning model accuracy reached 99.7%. Time to celebrate!",
            "Building the next generation of developer tools. Stay tuned for the announcement.",
            "Just discovered an amazing optimization technique. Reduced latency by 50%.",
            "The community response to our latest release has been incredible. Thank you all!",
            "Experimenting with holographic displays. The potential applications are endless."
        ];

        const tags = ['#coding', '#ai', '#web3', '#cyberpunk', '#tech', '#design', '#future', '#innovation', '#neural', '#quantum', '#vr', '#metaverse'];

        const gradients = [
            'linear-gradient(135deg, #00f2ea 0%, #9333ea 100%)',
            'linear-gradient(135deg, #ff006e 0%, #00f2ea 100%)',
            'linear-gradient(45deg, #9333ea 0%, #ff006e 100%)',
            'linear-gradient(180deg, #00ff88 0%, #00f2ea 100%)',
            'linear-gradient(90deg, #00f2ea 0%, #9333ea 50%, #ff006e 100%)'
        ];

        // State
        let postsLoaded = 0;
        let loadEvents = 0;
        let isLoading = false;
        let hasMorePosts = true;
        let observer = null;
        let loaderStyle = 'dots';
        let loadDelay = 1000;
        let batchSize = 5;
        let maxPosts = 50;

        // Generate post
        function generatePost(index) {
            const author = authors[index % authors.length];
            const content = contents[index % contents.length];
            const postTags = [tags[index % tags.length], tags[(index + 3) % tags.length]];
            const timeAgo = ['2m ago', '5m ago', '15m ago', '1h ago', '3h ago', '6h ago', '12h ago', '1d ago'][index % 8];
            const likes = Math.floor(Math.random() * 500) + 10;
            const comments = Math.floor(Math.random() * 100) + 5;
            const shares = Math.floor(Math.random() * 50) + 1;
            const hasImage = index % 3 === 0;
            const badge = index % 5 === 0 ? 'new' : (index % 7 === 0 ? 'trending' : null);

            return {
                id: index,
                author,
                content,
                tags: postTags,
                timeAgo,
                likes,
                comments,
                shares,
                hasImage,
                badge,
                gradient: gradients[index % gradients.length]
            };
        }

        // Create post element
        function createPostElement(post) {
            const article = document.createElement('article');
            article.className = 'post-card';
            article.style.animationDelay = `${(post.id % batchSize) * 0.1}s`;

            article.innerHTML = `
                <div class="post-header">
                    <div class="post-avatar" style="background: ${post.author.color}; color: #0a0a0f;">
                        ${post.author.name[0]}
                    </div>
                    <div class="post-meta">
                        <div class="post-author">
                            ${post.author.name}
                            <span>${post.author.handle}</span>
                        </div>
                        <div class="post-time">${post.timeAgo}</div>
                    </div>
                    ${post.badge ? `<span class="post-badge ${post.badge}">${post.badge}</span>` : ''}
                </div>
                <div class="post-content">${post.content}</div>
                ${post.hasImage ? `<div class="post-image" style="background: ${post.gradient}">üñºÔ∏è</div>` : ''}
                <div class="post-tags">
                    ${post.tags.map(tag => `<span class="post-tag">${tag}</span>`).join('')}
                </div>
                <div class="post-actions">
                    <span class="post-action" onclick="this.classList.toggle('liked')">
                        ‚ù§Ô∏è ${post.likes}
                    </span>
                    <span class="post-action">
                        üí¨ ${post.comments}
                    </span>
                    <span class="post-action">
                        üîÑ ${post.shares}
                    </span>
                    <span class="post-action">
                        üîñ Save
                    </span>
                </div>
            `;

            return article;
        }

        // Create loader element
        function createLoader() {
            const loader = document.createElement('div');
            loader.className = 'loader-container';
            loader.id = 'loader';

            let loaderHTML = '';
            switch (loaderStyle) {
                case 'spinner':
                    loaderHTML = '<div class="loader-spinner"></div>';
                    break;
                case 'dots':
                    loaderHTML = '<div class="loader-dots"><span></span><span></span><span></span></div>';
                    break;
                case 'bars':
                    loaderHTML = '<div class="loader-bars"><span></span><span></span><span></span><span></span><span></span></div>';
                    break;
                case 'pulse':
                    loaderHTML = '<div class="loader-pulse"></div>';
                    break;
                case 'wave':
                    loaderHTML = '<div class="loader-wave"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></div>';
                    break;
                case 'orbit':
                    loaderHTML = '<div class="loader-orbit"></div>';
                    break;
            }

            loader.innerHTML = `
                ${loaderHTML}
                <div class="loader-text">Loading more posts...</div>
            `;

            return loader;
        }

        // Create skeleton loader
        function createSkeletonLoader() {
            const skeleton = document.createElement('div');
            skeleton.className = 'skeleton-card';
            skeleton.innerHTML = `
                <div class="skeleton-header">
                    <div class="skeleton skeleton-avatar"></div>
                    <div class="skeleton-meta">
                        <div class="skeleton skeleton-name"></div>
                        <div class="skeleton skeleton-time"></div>
                    </div>
                </div>
                <div class="skeleton skeleton-content"></div>
                <div class="skeleton-actions">
                    <div class="skeleton skeleton-action"></div>
                    <div class="skeleton skeleton-action"></div>
                    <div class="skeleton skeleton-action"></div>
                </div>
            `;
            return skeleton;
        }

        // Create end message
        function createEndMessage() {
            const end = document.createElement('div');
            end.className = 'end-message';
            end.innerHTML = `
                <div class="end-icon">üéâ</div>
                <div class="end-title">You've reached the end!</div>
                <div class="end-text">No more posts to load. Check back later for new content.</div>
            `;
            return end;
        }

        // Load more posts
        async function loadMorePosts() {
            if (isLoading || !hasMorePosts) return;

            isLoading = true;
            document.getElementById('feedStatus').textContent = 'Loading...';
            document.getElementById('feedStatus').className = 'info-value highlight';

            const container = document.getElementById('feedContainer');
            const loader = createLoader();
            container.appendChild(loader);

            // Simulate network delay
            await new Promise(resolve => setTimeout(resolve, loadDelay));

            // Remove loader
            loader.remove();

            // Calculate how many posts to load
            const remaining = maxPosts > 0 ? maxPosts - postsLoaded : batchSize;
            const toLoad = Math.min(batchSize, remaining);

            if (toLoad <= 0 && maxPosts > 0) {
                hasMorePosts = false;
                container.appendChild(createEndMessage());
                document.getElementById('feedStatus').textContent = 'Complete';
                document.getElementById('feedStatus').className = 'info-value';
                isLoading = false;
                return;
            }

            // Create and append new posts
            const fragment = document.createDocumentFragment();
            for (let i = 0; i < toLoad; i++) {
                const post = generatePost(postsLoaded + i);
                fragment.appendChild(createPostElement(post));
            }
            container.appendChild(fragment);

            postsLoaded += toLoad;
            loadEvents++;

            // Update stats
            document.getElementById('postsLoaded').textContent = postsLoaded;
            document.getElementById('loadEvents').textContent = loadEvents;
            document.getElementById('feedStatus').textContent = 'Ready';
            document.getElementById('feedStatus').className = 'info-value success';

            // Check if we've reached the limit
            if (maxPosts > 0 && postsLoaded >= maxPosts) {
                hasMorePosts = false;
                container.appendChild(createEndMessage());
                document.getElementById('feedStatus').textContent = 'Complete';
            }

            isLoading = false;

            // Re-observe last post
            observeLastPost();
        }

        // Setup intersection observer for infinite scroll
        function setupInfiniteScroll() {
            observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting && hasMorePosts && !isLoading) {
                        loadMorePosts();
                    }
                });
            }, {
                root: null,
                rootMargin: '200px',
                threshold: 0
            });

            observeLastPost();
        }

        // Observe the last post
        function observeLastPost() {
            if (observer) {
                const posts = document.querySelectorAll('.post-card');
                if (posts.length > 0) {
                    // Unobserve previous last post
                    posts.forEach(post => observer.unobserve(post));
                    // Observe new last post
                    observer.observe(posts[posts.length - 1]);
                }
            }
        }

        // Reset feed
        function resetFeed() {
            postsLoaded = 0;
            loadEvents = 0;
            hasMorePosts = true;
            isLoading = false;

            const container = document.getElementById('feedContainer');
            container.innerHTML = '';

            document.getElementById('postsLoaded').textContent = '0';
            document.getElementById('loadEvents').textContent = '0';
            document.getElementById('feedStatus').textContent = 'Ready';
            document.getElementById('feedStatus').className = 'info-value success';

            // Load initial batch
            loadMorePosts();
        }

        // Update scroll progress
        function updateScrollProgress() {
            const scrollTop = window.scrollY;
            const docHeight = document.documentElement.scrollHeight - window.innerHeight;
            const progress = docHeight > 0 ? (scrollTop / docHeight) * 100 : 0;

            document.getElementById('scrollProgress').style.width = `${progress}%`;
            document.getElementById('scrollPosition').textContent = `${Math.round(progress)}%`;

            // Show/hide back to top button
            const backToTop = document.getElementById('backToTop');
            if (scrollTop > 500) {
                backToTop.classList.add('visible');
            } else {
                backToTop.classList.remove('visible');
            }
        }

        // Setup controls
        function setupControls() {
            document.getElementById('loaderStyle').addEventListener('change', (e) => {
                loaderStyle = e.target.value;
            });

            document.getElementById('loadDelay').addEventListener('change', (e) => {
                loadDelay = parseInt(e.target.value);
            });

            document.getElementById('batchSize').addEventListener('change', (e) => {
                batchSize = parseInt(e.target.value);
            });

            document.getElementById('totalPosts').addEventListener('change', (e) => {
                maxPosts = parseInt(e.target.value);
                resetFeed();
            });

            document.getElementById('resetBtn').addEventListener('click', resetFeed);

            document.getElementById('backToTop').addEventListener('click', () => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });

            // Filter buttons (visual only for demo)
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                });
            });

            window.addEventListener('scroll', updateScrollProgress, { passive: true });
        }

        // Initialize
        function init() {
            setupControls();
            setupInfiniteScroll();
            loadMorePosts();
        }

        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
