<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Confetti Celebration - JaZeR</title>
    <link rel="stylesheet" href="../../../jazer-brand.css">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: var(--font-body); 
            background: linear-gradient(135deg, #0a0a0a 0%, #1a0a2e 50%, #0a0a0a 100%); 
            min-height: 100vh; 
            padding: 2rem; 
            color: white;
            overflow-x: hidden;
        }
        
        .container { max-width: 1100px; margin: 0 auto; }
        
        .back-button { 
            display: inline-flex; 
            align-items: center; 
            gap: 0.5rem; 
            color: var(--jazer-cyan); 
            text-decoration: none; 
            padding: 0.75rem 1.5rem; 
            border: 2px solid var(--jazer-cyan); 
            border-radius: 12px; 
            background: rgba(0, 255, 255, 0.1); 
            transition: all 0.3s ease; 
            margin-bottom: 2rem; 
        }
        .back-button:hover { 
            background: var(--jazer-cyan); 
            color: #0a0a0a; 
            transform: translateX(-5px); 
        }
        
        .hero-section {
            text-align: center;
            padding: 2rem 0 3rem;
        }
        
        h1 { 
            font-family: var(--font-primary); 
            font-size: clamp(2rem, 5vw, 3rem); 
            background: linear-gradient(135deg, var(--jazer-cyan), var(--jazer-purple), var(--jazer-pink)); 
            -webkit-background-clip: text; 
            -webkit-text-fill-color: transparent; 
            background-clip: text; 
            margin-bottom: 1rem;
            text-shadow: 0 0 40px rgba(0, 242, 234, 0.3);
        }
        
        .subtitle {
            color: rgba(255, 255, 255, 0.7);
            font-size: 1.1rem;
            max-width: 600px;
            margin: 0 auto;
        }
        
        .keyboard-hint {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            margin-top: 1rem;
            padding: 0.5rem 1rem;
            background: rgba(147, 51, 234, 0.2);
            border: 1px solid var(--jazer-purple);
            border-radius: 8px;
            font-size: 0.85rem;
            color: var(--jazer-purple);
        }
        
        .keyboard-hint kbd {
            background: rgba(147, 51, 234, 0.3);
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            font-family: var(--font-secondary);
        }
        
        /* Confetti Canvas */
        #confetti-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1000;
        }
        
        /* Controls Section */
        .controls-section {
            background: rgba(10, 10, 10, 0.8);
            border: 2px solid var(--jazer-cyan);
            border-radius: 20px;
            padding: 2rem;
            backdrop-filter: blur(10px);
            margin-bottom: 2rem;
        }
        
        .section-title {
            font-family: var(--font-secondary);
            font-size: 1.3rem;
            color: var(--jazer-cyan);
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .controls-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .control-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        
        .control-group label {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.7);
            font-family: var(--font-secondary);
        }
        
        .control-group select,
        .control-group input[type="range"] {
            padding: 0.75rem;
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: white;
            font-family: var(--font-body);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .control-group select:hover,
        .control-group select:focus {
            border-color: var(--jazer-cyan);
            outline: none;
        }
        
        .control-group select option {
            background: #1a1a2e;
            color: white;
        }
        
        .range-value {
            font-size: 0.85rem;
            color: var(--jazer-cyan);
            text-align: right;
        }
        
        input[type="range"] {
            -webkit-appearance: none;
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
        }
        
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            background: linear-gradient(135deg, var(--jazer-cyan), var(--jazer-purple));
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 0 10px var(--jazer-cyan);
        }
        
        /* Trigger Buttons */
        .trigger-section {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            justify-content: center;
        }
        
        .trigger-btn {
            padding: 1rem 2rem;
            font-size: 1rem;
            font-weight: 600;
            border: 2px solid;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: var(--font-secondary);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            position: relative;
            overflow: hidden;
        }
        
        .trigger-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s ease;
        }
        
        .trigger-btn:hover::before {
            left: 100%;
        }
        
        .trigger-btn.primary {
            border-color: var(--jazer-cyan);
            background: rgba(0, 242, 234, 0.15);
            color: var(--jazer-cyan);
        }
        
        .trigger-btn.primary:hover {
            background: var(--jazer-cyan);
            color: #0a0a0a;
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(0, 242, 234, 0.3);
        }
        
        .trigger-btn.success {
            border-color: #00ff88;
            background: rgba(0, 255, 136, 0.15);
            color: #00ff88;
        }
        
        .trigger-btn.success:hover {
            background: #00ff88;
            color: #0a0a0a;
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(0, 255, 136, 0.3);
        }
        
        .trigger-btn.party {
            border-color: var(--jazer-pink);
            background: rgba(255, 0, 110, 0.15);
            color: var(--jazer-pink);
        }
        
        .trigger-btn.party:hover {
            background: var(--jazer-pink);
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(255, 0, 110, 0.3);
        }
        
        .trigger-btn.gold {
            border-color: #ffd700;
            background: rgba(255, 215, 0, 0.15);
            color: #ffd700;
        }
        
        .trigger-btn.gold:hover {
            background: #ffd700;
            color: #0a0a0a;
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(255, 215, 0, 0.3);
        }
        
        /* Demo Cards */
        .demo-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .demo-card {
            background: rgba(10, 10, 10, 0.8);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 1.5rem;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }
        
        .demo-card:hover {
            border-color: var(--jazer-purple);
            transform: translateY(-5px);
        }
        
        .demo-card h3 {
            font-family: var(--font-secondary);
            font-size: 1.1rem;
            color: var(--jazer-purple);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .demo-card p {
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.9rem;
            margin-bottom: 1rem;
            line-height: 1.5;
        }
        
        .demo-preview {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 12px;
            padding: 2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 120px;
            position: relative;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .demo-preview:hover {
            background: rgba(0, 0, 0, 0.6);
        }
        
        .demo-preview .click-hint {
            position: absolute;
            bottom: 0.5rem;
            right: 0.5rem;
            font-size: 0.75rem;
            color: rgba(255, 255, 255, 0.4);
        }
        
        /* Achievement Demo */
        .achievement-badge {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
            opacity: 0;
            transform: scale(0);
            transition: all 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        
        .achievement-badge.show {
            opacity: 1;
            transform: scale(1);
        }
        
        .achievement-badge .icon {
            font-size: 3rem;
            animation: bounce 0.6s ease infinite;
        }
        
        .achievement-badge .text {
            font-family: var(--font-secondary);
            color: #ffd700;
            font-size: 1rem;
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        /* Level Up Demo */
        .level-up {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
        }
        
        .level-display {
            font-family: var(--font-primary);
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--jazer-cyan), var(--jazer-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            transition: all 0.3s ease;
        }
        
        .level-display.animating {
            animation: levelPulse 0.5s ease;
        }
        
        @keyframes levelPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.3); filter: brightness(1.5); }
            100% { transform: scale(1); }
        }
        
        .xp-bar {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
        }
        
        .xp-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--jazer-cyan), var(--jazer-purple));
            border-radius: 4px;
            transition: width 0.5s ease;
            box-shadow: 0 0 10px var(--jazer-cyan);
        }
        
        /* Completion Demo */
        .completion-circle {
            width: 100px;
            height: 100px;
            position: relative;
        }
        
        .completion-circle svg {
            transform: rotate(-90deg);
        }
        
        .completion-circle .bg {
            fill: none;
            stroke: rgba(255, 255, 255, 0.1);
            stroke-width: 8;
        }
        
        .completion-circle .progress {
            fill: none;
            stroke: url(#completionGradient);
            stroke-width: 8;
            stroke-linecap: round;
            stroke-dasharray: 283;
            stroke-dashoffset: 283;
            transition: stroke-dashoffset 1s ease;
        }
        
        .completion-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-family: var(--font-secondary);
            font-size: 1.5rem;
            color: white;
        }
        
        /* Presets Section */
        .presets-section {
            background: rgba(10, 10, 10, 0.8);
            border: 2px solid var(--jazer-purple);
            border-radius: 20px;
            padding: 2rem;
            backdrop-filter: blur(10px);
        }
        
        .preset-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
        }
        
        .preset-btn {
            padding: 1rem;
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
        }
        
        .preset-btn:hover {
            border-color: var(--jazer-purple);
            background: rgba(147, 51, 234, 0.2);
            transform: translateY(-3px);
        }
        
        .preset-btn .icon {
            font-size: 2rem;
        }
        
        .preset-btn .name {
            font-family: var(--font-secondary);
            font-size: 0.9rem;
        }
        
        /* Footer */
        .footer-info {
            margin-top: 2rem;
            padding: 1.5rem;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .footer-info h4 {
            color: var(--jazer-cyan);
            font-family: var(--font-secondary);
            margin-bottom: 0.75rem;
        }
        
        .footer-info ul {
            list-style: none;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 0.5rem;
        }
        
        .footer-info li {
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.85rem;
            padding-left: 1rem;
            position: relative;
        }
        
        .footer-info li::before {
            content: '‚ñ∏';
            position: absolute;
            left: 0;
            color: var(--jazer-purple);
        }
        
        @media (max-width: 768px) {
            body { padding: 1rem; }
            .controls-grid { grid-template-columns: 1fr; }
            .trigger-section { flex-direction: column; }
            .trigger-btn { justify-content: center; }
        }
    </style>
</head>
<body>
    <canvas id="confetti-canvas"></canvas>
    
    <div class="container">
        <a href="index.html" class="back-button">‚Üê Back</a>
        
        <section class="hero-section">
            <h1>Confetti Celebration</h1>
            <p class="subtitle">Canvas-based confetti animations for celebrating achievements, completions, and special moments</p>
            <div class="keyboard-hint">
                <kbd>Space</kbd> to trigger confetti burst
            </div>
        </section>
        
        <!-- Controls -->
        <section class="controls-section">
            <h2 class="section-title">‚öôÔ∏è Confetti Settings</h2>
            
            <div class="controls-grid">
                <div class="control-group">
                    <label>Confetti Style</label>
                    <select id="confetti-style">
                        <option value="classic">Classic Rectangles</option>
                        <option value="circles">Circle Dots</option>
                        <option value="stars">Stars</option>
                        <option value="hearts">Hearts</option>
                        <option value="mixed">Mixed Shapes</option>
                    </select>
                </div>
                
                <div class="control-group">
                    <label>Color Scheme</label>
                    <select id="color-scheme">
                        <option value="rainbow">Rainbow</option>
                        <option value="neon">Neon Cyberpunk</option>
                        <option value="gold">Gold & Silver</option>
                        <option value="pastel">Pastel</option>
                        <option value="monochrome">Monochrome Cyan</option>
                    </select>
                </div>
                
                <div class="control-group">
                    <label>Particle Count: <span id="count-value" class="range-value">150</span></label>
                    <input type="range" id="particle-count" min="50" max="500" value="150">
                </div>
                
                <div class="control-group">
                    <label>Gravity: <span id="gravity-value" class="range-value">1.0</span></label>
                    <input type="range" id="gravity" min="0.2" max="2" step="0.1" value="1">
                </div>
                
                <div class="control-group">
                    <label>Animation Duration</label>
                    <select id="duration">
                        <option value="2000">Quick (2s)</option>
                        <option value="4000" selected>Normal (4s)</option>
                        <option value="6000">Extended (6s)</option>
                        <option value="10000">Long (10s)</option>
                    </select>
                </div>
                
                <div class="control-group">
                    <label>Launch Pattern</label>
                    <select id="launch-pattern">
                        <option value="burst">Center Burst</option>
                        <option value="cannon-left">Cannon Left</option>
                        <option value="cannon-right">Cannon Right</option>
                        <option value="cannon-both">Cannon Both</option>
                        <option value="rain">Rain Down</option>
                        <option value="firework">Firework</option>
                    </select>
                </div>
            </div>
            
            <div class="trigger-section">
                <button class="trigger-btn primary" onclick="triggerConfetti()">
                    üéä Launch Confetti
                </button>
                <button class="trigger-btn success" onclick="triggerSuccess()">
                    ‚úì Success Burst
                </button>
                <button class="trigger-btn party" onclick="triggerParty()">
                    üéâ Party Mode
                </button>
                <button class="trigger-btn gold" onclick="triggerGold()">
                    üèÜ Golden Shower
                </button>
            </div>
        </section>
        
        <!-- Demo Cards -->
        <section class="demo-grid">
            <div class="demo-card">
                <h3>üèÜ Achievement Unlocked</h3>
                <p>Trigger confetti when users unlock achievements or badges</p>
                <div class="demo-preview" onclick="triggerAchievement()">
                    <div class="achievement-badge" id="achievement-badge">
                        <span class="icon">üèÜ</span>
                        <span class="text">First Victory!</span>
                    </div>
                    <span class="click-hint">Click to demo</span>
                </div>
            </div>
            
            <div class="demo-card">
                <h3>‚¨ÜÔ∏è Level Up</h3>
                <p>Celebrate when users reach a new level or milestone</p>
                <div class="demo-preview" onclick="triggerLevelUp()">
                    <div class="level-up">
                        <div class="level-display" id="level-display">LVL 1</div>
                        <div class="xp-bar">
                            <div class="xp-fill" id="xp-fill" style="width: 75%"></div>
                        </div>
                    </div>
                    <span class="click-hint">Click to level up</span>
                </div>
            </div>
            
            <div class="demo-card">
                <h3>‚úì Task Complete</h3>
                <p>Reward users when they complete tasks or goals</p>
                <div class="demo-preview" onclick="triggerCompletion()">
                    <div class="completion-circle" id="completion-circle">
                        <svg width="100" height="100">
                            <defs>
                                <linearGradient id="completionGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                    <stop offset="0%" style="stop-color:#00f2ea"/>
                                    <stop offset="100%" style="stop-color:#9333ea"/>
                                </linearGradient>
                            </defs>
                            <circle class="bg" cx="50" cy="50" r="45"/>
                            <circle class="progress" id="completion-progress" cx="50" cy="50" r="45"/>
                        </svg>
                        <span class="completion-text" id="completion-text">75%</span>
                    </div>
                    <span class="click-hint">Click to complete</span>
                </div>
            </div>
        </section>
        
        <!-- Presets -->
        <section class="presets-section">
            <h2 class="section-title">üé® Quick Presets</h2>
            
            <div class="preset-grid">
                <button class="preset-btn" onclick="applyPreset('birthday')">
                    <span class="icon">üéÇ</span>
                    <span class="name">Birthday</span>
                </button>
                <button class="preset-btn" onclick="applyPreset('newyear')">
                    <span class="icon">üéÜ</span>
                    <span class="name">New Year</span>
                </button>
                <button class="preset-btn" onclick="applyPreset('winner')">
                    <span class="icon">ü•á</span>
                    <span class="name">Winner</span>
                </button>
                <button class="preset-btn" onclick="applyPreset('love')">
                    <span class="icon">‚ù§Ô∏è</span>
                    <span class="name">Love</span>
                </button>
                <button class="preset-btn" onclick="applyPreset('money')">
                    <span class="icon">üí∞</span>
                    <span class="name">Jackpot</span>
                </button>
                <button class="preset-btn" onclick="applyPreset('snow')">
                    <span class="icon">‚ùÑÔ∏è</span>
                    <span class="name">Snowfall</span>
                </button>
            </div>
        </section>
        
        <div class="footer-info">
            <h4>Features</h4>
            <ul>
                <li>Canvas-based rendering for smooth performance</li>
                <li>5 confetti shapes: rectangles, circles, stars, hearts, mixed</li>
                <li>5 color schemes with customizable palettes</li>
                <li>6 launch patterns for different effects</li>
                <li>Adjustable particle count and gravity</li>
                <li>Quick presets for common celebrations</li>
                <li>Keyboard shortcut (Space) support</li>
                <li>Mobile-responsive touch interactions</li>
            </ul>
        </div>
    </div>
    
    <script>
        // Canvas setup
        const canvas = document.getElementById('confetti-canvas');
        const ctx = canvas.getContext('2d');
        let particles = [];
        let animationId = null;
        
        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);
        
        // Color schemes
        const colorSchemes = {
            rainbow: ['#ff0000', '#ff7700', '#ffdd00', '#00ff00', '#0099ff', '#6633ff', '#ff00ff'],
            neon: ['#00f2ea', '#9333ea', '#ff006e', '#00ff88', '#ffdd00', '#ff3366'],
            gold: ['#ffd700', '#ffec8b', '#c0c0c0', '#e8e8e8', '#b8860b', '#daa520'],
            pastel: ['#ffb3ba', '#ffdfba', '#ffffba', '#baffc9', '#bae1ff', '#e0bbff'],
            monochrome: ['#00f2ea', '#00d4cc', '#00b8b0', '#009c96', '#00807c', '#006462']
        };
        
        // Particle class
        class Particle {
            constructor(x, y, color, style, velocityX, velocityY) {
                this.x = x;
                this.y = y;
                this.color = color;
                this.style = style;
                this.velocityX = velocityX;
                this.velocityY = velocityY;
                this.gravity = parseFloat(document.getElementById('gravity').value) * 0.15;
                this.rotation = Math.random() * 360;
                this.rotationSpeed = (Math.random() - 0.5) * 10;
                this.size = Math.random() * 10 + 5;
                this.opacity = 1;
                this.decay = Math.random() * 0.01 + 0.005;
            }
            
            update() {
                this.velocityY += this.gravity;
                this.x += this.velocityX;
                this.y += this.velocityY;
                this.rotation += this.rotationSpeed;
                this.velocityX *= 0.99;
                this.opacity -= this.decay;
            }
            
            draw() {
                ctx.save();
                ctx.translate(this.x, this.y);
                ctx.rotate(this.rotation * Math.PI / 180);
                ctx.globalAlpha = Math.max(0, this.opacity);
                ctx.fillStyle = this.color;
                
                switch(this.style) {
                    case 'classic':
                        ctx.fillRect(-this.size / 2, -this.size / 4, this.size, this.size / 2);
                        break;
                    case 'circles':
                        ctx.beginPath();
                        ctx.arc(0, 0, this.size / 2, 0, Math.PI * 2);
                        ctx.fill();
                        break;
                    case 'stars':
                        this.drawStar(0, 0, 5, this.size / 2, this.size / 4);
                        break;
                    case 'hearts':
                        this.drawHeart(0, 0, this.size / 3);
                        break;
                    case 'mixed':
                        const shapes = ['classic', 'circles', 'stars'];
                        const shape = shapes[Math.floor(this.x + this.y) % shapes.length];
                        if (shape === 'classic') {
                            ctx.fillRect(-this.size / 2, -this.size / 4, this.size, this.size / 2);
                        } else if (shape === 'circles') {
                            ctx.beginPath();
                            ctx.arc(0, 0, this.size / 2, 0, Math.PI * 2);
                            ctx.fill();
                        } else {
                            this.drawStar(0, 0, 5, this.size / 2, this.size / 4);
                        }
                        break;
                }
                
                ctx.restore();
            }
            
            drawStar(cx, cy, spikes, outerRadius, innerRadius) {
                let rot = Math.PI / 2 * 3;
                let x = cx;
                let y = cy;
                const step = Math.PI / spikes;
                
                ctx.beginPath();
                ctx.moveTo(cx, cy - outerRadius);
                
                for (let i = 0; i < spikes; i++) {
                    x = cx + Math.cos(rot) * outerRadius;
                    y = cy + Math.sin(rot) * outerRadius;
                    ctx.lineTo(x, y);
                    rot += step;
                    
                    x = cx + Math.cos(rot) * innerRadius;
                    y = cy + Math.sin(rot) * innerRadius;
                    ctx.lineTo(x, y);
                    rot += step;
                }
                
                ctx.lineTo(cx, cy - outerRadius);
                ctx.closePath();
                ctx.fill();
            }
            
            drawHeart(x, y, size) {
                ctx.beginPath();
                ctx.moveTo(x, y + size / 4);
                ctx.bezierCurveTo(x, y, x - size / 2, y, x - size / 2, y + size / 4);
                ctx.bezierCurveTo(x - size / 2, y + size / 2, x, y + size * 0.75, x, y + size);
                ctx.bezierCurveTo(x, y + size * 0.75, x + size / 2, y + size / 2, x + size / 2, y + size / 4);
                ctx.bezierCurveTo(x + size / 2, y, x, y, x, y + size / 4);
                ctx.fill();
            }
        }
        
        // Create particles based on settings
        function createParticles(overrides = {}) {
            const count = overrides.count || parseInt(document.getElementById('particle-count').value);
            const style = overrides.style || document.getElementById('confetti-style').value;
            const scheme = overrides.scheme || document.getElementById('color-scheme').value;
            const pattern = overrides.pattern || document.getElementById('launch-pattern').value;
            const colors = colorSchemes[scheme];
            
            for (let i = 0; i < count; i++) {
                let x, y, velocityX, velocityY;
                
                switch(pattern) {
                    case 'burst':
                        x = canvas.width / 2;
                        y = canvas.height / 2;
                        const angle = Math.random() * Math.PI * 2;
                        const speed = Math.random() * 15 + 5;
                        velocityX = Math.cos(angle) * speed;
                        velocityY = Math.sin(angle) * speed - 5;
                        break;
                    case 'cannon-left':
                        x = 0;
                        y = canvas.height;
                        velocityX = Math.random() * 15 + 10;
                        velocityY = -(Math.random() * 20 + 15);
                        break;
                    case 'cannon-right':
                        x = canvas.width;
                        y = canvas.height;
                        velocityX = -(Math.random() * 15 + 10);
                        velocityY = -(Math.random() * 20 + 15);
                        break;
                    case 'cannon-both':
                        if (i % 2 === 0) {
                            x = 0;
                            velocityX = Math.random() * 15 + 10;
                        } else {
                            x = canvas.width;
                            velocityX = -(Math.random() * 15 + 10);
                        }
                        y = canvas.height;
                        velocityY = -(Math.random() * 20 + 15);
                        break;
                    case 'rain':
                        x = Math.random() * canvas.width;
                        y = -20;
                        velocityX = (Math.random() - 0.5) * 4;
                        velocityY = Math.random() * 3 + 2;
                        break;
                    case 'firework':
                        x = canvas.width / 2 + (Math.random() - 0.5) * 100;
                        y = canvas.height / 3;
                        const fwAngle = Math.random() * Math.PI * 2;
                        const fwSpeed = Math.random() * 12 + 3;
                        velocityX = Math.cos(fwAngle) * fwSpeed;
                        velocityY = Math.sin(fwAngle) * fwSpeed;
                        break;
                }
                
                const color = colors[Math.floor(Math.random() * colors.length)];
                particles.push(new Particle(x, y, color, style, velocityX, velocityY));
            }
        }
        
        // Animation loop
        function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            particles = particles.filter(p => p.opacity > 0 && p.y < canvas.height + 100);
            
            particles.forEach(p => {
                p.update();
                p.draw();
            });
            
            if (particles.length > 0) {
                animationId = requestAnimationFrame(animate);
            }
        }
        
        // Trigger functions
        function triggerConfetti(overrides = {}) {
            createParticles(overrides);
            if (!animationId || particles.length === 0) {
                animate();
            }
            
            const duration = parseInt(document.getElementById('duration').value);
            setTimeout(() => {
                // Allow natural fade out
            }, duration);
        }
        
        function triggerSuccess() {
            triggerConfetti({ scheme: 'neon', pattern: 'burst', count: 100 });
        }
        
        function triggerParty() {
            triggerConfetti({ scheme: 'rainbow', pattern: 'cannon-both', count: 200 });
            setTimeout(() => triggerConfetti({ scheme: 'rainbow', pattern: 'burst', count: 100 }), 500);
            setTimeout(() => triggerConfetti({ scheme: 'rainbow', pattern: 'cannon-both', count: 200 }), 1000);
        }
        
        function triggerGold() {
            triggerConfetti({ scheme: 'gold', style: 'stars', pattern: 'firework', count: 150 });
        }
        
        // Demo functions
        let currentLevel = 1;
        
        function triggerAchievement() {
            const badge = document.getElementById('achievement-badge');
            badge.classList.remove('show');
            
            setTimeout(() => {
                badge.classList.add('show');
                triggerConfetti({ scheme: 'gold', pattern: 'burst', count: 80, style: 'stars' });
            }, 100);
            
            setTimeout(() => {
                badge.classList.remove('show');
            }, 3000);
        }
        
        function triggerLevelUp() {
            const display = document.getElementById('level-display');
            const xpFill = document.getElementById('xp-fill');
            
            xpFill.style.width = '100%';
            
            setTimeout(() => {
                currentLevel++;
                display.textContent = `LVL ${currentLevel}`;
                display.classList.add('animating');
                xpFill.style.width = '0%';
                
                triggerConfetti({ scheme: 'neon', pattern: 'burst', count: 120 });
                
                setTimeout(() => {
                    display.classList.remove('animating');
                    xpFill.style.width = '25%';
                }, 500);
            }, 300);
        }
        
        let completionPercent = 75;
        
        function triggerCompletion() {
            const progress = document.getElementById('completion-progress');
            const text = document.getElementById('completion-text');
            
            completionPercent = 100;
            const offset = 283 - (283 * completionPercent / 100);
            progress.style.strokeDashoffset = offset;
            text.textContent = '100%';
            
            setTimeout(() => {
                triggerConfetti({ scheme: 'neon', pattern: 'firework', count: 100, style: 'mixed' });
            }, 500);
            
            setTimeout(() => {
                completionPercent = 75;
                const resetOffset = 283 - (283 * completionPercent / 100);
                progress.style.strokeDashoffset = resetOffset;
                text.textContent = '75%';
            }, 4000);
        }
        
        // Initialize completion circle
        document.addEventListener('DOMContentLoaded', () => {
            const progress = document.getElementById('completion-progress');
            const offset = 283 - (283 * 75 / 100);
            progress.style.strokeDashoffset = offset;
        });
        
        // Presets
        function applyPreset(preset) {
            const presets = {
                birthday: { style: 'mixed', scheme: 'rainbow', pattern: 'cannon-both', count: 200 },
                newyear: { style: 'stars', scheme: 'gold', pattern: 'firework', count: 250 },
                winner: { style: 'stars', scheme: 'gold', pattern: 'burst', count: 150 },
                love: { style: 'hearts', scheme: 'pastel', pattern: 'rain', count: 100 },
                money: { style: 'classic', scheme: 'gold', pattern: 'rain', count: 200 },
                snow: { style: 'circles', scheme: 'monochrome', pattern: 'rain', count: 150 }
            };
            
            const p = presets[preset];
            document.getElementById('confetti-style').value = p.style;
            document.getElementById('color-scheme').value = p.scheme;
            document.getElementById('launch-pattern').value = p.pattern;
            document.getElementById('particle-count').value = p.count;
            document.getElementById('count-value').textContent = p.count;
            
            triggerConfetti(p);
        }
        
        // Range input updates
        document.getElementById('particle-count').addEventListener('input', (e) => {
            document.getElementById('count-value').textContent = e.target.value;
        });
        
        document.getElementById('gravity').addEventListener('input', (e) => {
            document.getElementById('gravity-value').textContent = e.target.value;
        });
        
        // Keyboard shortcut
        document.addEventListener('keydown', (e) => {
            if (e.code === 'Space' && e.target.tagName !== 'INPUT' && e.target.tagName !== 'SELECT') {
                e.preventDefault();
                triggerConfetti();
            }
        });
    </script>
</body>
</html>
