<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Text Utilities - JaZeR CSS Patterns</title>
  <link rel="stylesheet" href="../../../jazer-brand.css">
  <style>
    *{box-sizing:border-box;margin:0;padding:0}
    :root{--panel-gap:1.25rem}
    body{font-family:var(--font-body);background:var(--bg-dark);color:var(--text-light);padding:2rem}
    .container{max-width:1400px;margin:0 auto}
    .back-button{display:inline-flex;align-items:center;gap:.5rem;padding:.5rem 1rem;border-radius:10px;border:2px solid var(--border-default);color:var(--text-gray);background:var(--bg-card);text-decoration:none;font-weight:700}
    .back-button:hover{color:var(--jazer-cyan);border-color:var(--jazer-cyan);transform:translateX(-4px)}
    .hero{padding:2rem 1.25rem;border-radius:16px;background:linear-gradient(135deg,rgba(6,182,212,.04),rgba(147,51,234,.04));border:2px solid rgba(6,182,212,.12);text-align:center}
    .hero h1{font-family:var(--font-primary);font-size:clamp(1.6rem,4vw,2.6rem);font-weight:900;background:var(--gradient-text);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
    .hero p{color:var(--text-gray);margin-top:.6rem}
    .main-grid{display:grid;gap:var(--panel-gap);grid-template-columns:1fr}
    @media(min-width:1000px){.main-grid{grid-template-columns:1fr 380px}}
    .panel{background:var(--bg-card);border:2px solid var(--border-default);border-radius:12px;padding:1rem}
    .panel-header{display:flex;align-items:center;justify-content:space-between;gap:.75rem;padding-bottom:.75rem;border-bottom:1px solid var(--border-default)}
    .panel-title{font-weight:800;font-family:var(--font-secondary)}
    .toolbar{display:flex;gap:.5rem}
    .btn{padding:.55rem .85rem;border-radius:8px;border:2px solid var(--border-default);background:var(--bg-card);color:var(--text-light);font-family:var(--font-secondary);font-weight:700;cursor:pointer}
    .btn:hover{border-color:var(--jazer-cyan);color:var(--jazer-cyan);transform:translateY(-2px)}
    .btn-primary{background:var(--gradient-accent);border-color:transparent;color:white}

    .demo-area{padding:1rem;display:flex;flex-direction:column;gap:1rem}
    .demo-preview{background:rgba(0,0,0,.36);padding:1.25rem;border-radius:10px;border:2px solid var(--border-default);min-height:260px;transition:border-color .2s ease,box-shadow .2s ease}
    .demo-preview:hover{border-color:var(--jazer-cyan);box-shadow:0 12px 30px rgba(0,242,234,.06)}
    .text-sample{color:var(--text-light);font-size:16px;line-height:1.6}
    .text-title{font-family:var(--font-primary);font-size:1.6rem;margin-bottom:.4rem}
    .text-leadin{color:var(--text-gray);margin-bottom:.6rem}
    details{background:transparent;border:2px solid var(--border-default);border-radius:8px;overflow:hidden}
    summary{display:flex;align-items:center;justify-content:space-between;padding:.8rem 1rem;cursor:pointer;font-family:var(--font-secondary);font-weight:700}
    .details-content{padding:1rem;border-top:1px solid var(--border-default)}
    .controls-panel{display:flex;flex-direction:column;gap:1rem}
    .control-row{display:flex;justify-content:space-between;align-items:center;gap:.6rem;padding:.6rem 0}
    .control-label{font-family:var(--font-secondary);color:var(--text-gray);font-size:.9rem}

    .variants-grid{display:grid;gap:1rem;grid-template-columns:repeat(auto-fill,minmax(260px,1fr))}
    .variant-card{padding:.85rem;background:rgba(255,255,255,.02);border:1px solid var(--border-default);border-radius:8px;display:flex;flex-direction:column;gap:.5rem}
    .variant-name{font-weight:800;color:var(--jazer-cyan)}
    .variant-example{background:rgba(255,255,255,.02);padding:.6rem;border-radius:6px;font-size:.95rem}
    .variant-desc{font-size:.85rem;color:var(--text-gray)}

    .cheatsheet{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:.6rem;margin-top:1rem}
    .cheat-card{background:rgba(0,0,0,.36);padding:.6rem;border-radius:8px;border:1px solid var(--border-default)}

    .status-bar{margin-top:1.25rem;padding:.75rem 1rem;border-radius:8px;display:flex;justify-content:space-between;gap:1rem;align-items:center;border:2px solid var(--border-default);background:var(--bg-card)}
    .status-items{display:flex;gap:1rem;align-items:center}
    .status-item{display:flex;gap:.4rem;align-items:center;color:var(--text-gray);font-size:.9rem;font-family:var(--font-secondary)}
    .status-value{color:var(--jazer-cyan);font-weight:800}

    .text-muted{color:var(--text-gray)}
    .text-accent{color:var(--jazer-cyan)}
    .text-uppercase{text-transform:uppercase;letter-spacing:.04em}
    .text-lowercase{text-transform:lowercase}
    .text-capitalize{text-transform:capitalize}
    .text-mono{font-family:monospace}
    .text-ellipsis{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}
    .text-truncate-2{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}
    .text-truncate-3{display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden}
    .text-strong{font-weight:800}
    .text-light{font-weight:300}
    .text-gradient{background:var(--gradient-text);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
    .text-neon{text-shadow:0 2px 12px rgba(0,242,234,.25)}
    .text-shadow{text-shadow:0 2px 6px rgba(0,0,0,.75)}
    .text-underline{text-decoration:underline}
    .text-overline{text-decoration:overline}
    .text-strike{text-decoration:line-through}
    .text-highlight{background:rgba(255,200,40,.08);padding:.05rem .2rem;border-radius:4px;color:#ffb200}
    .text-dropcap::first-letter{float:left;font-size:3.2rem;line-height:1;margin-right:.3rem;font-weight:900}
    .text-danger{color:var(--jazer-pink)}
    .text-success{color:#10b981}
    .text-warning{color:#ffbe0b}
    .text-info{color:var(--jazer-cyan)}
    .text-link{color:var(--jazer-cyan);text-decoration:underline}
    .text-outline{color:transparent;-webkit-text-stroke:1px var(--text-light)}
    .text-outline-strong{color:transparent;-webkit-text-stroke:1.6px var(--jazer-cyan)}
    .text-ghost{color:rgba(255,255,255,.16)}
    .text-inverse{color:var(--bg-dark);background:var(--text-light);padding:.05rem .2rem;border-radius:2px}
    .text-gradient-accent{background:linear-gradient(90deg,var(--jazer-cyan),var(--jazer-pink));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
    .text-gradient-vertical{background:linear-gradient(180deg,var(--jazer-cyan),var(--jazer-purple));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
    .text-outline-light{color:transparent;-webkit-text-stroke:1px rgba(255,255,255,.6)}
    .text-cta{padding:.3rem .6rem;border-radius:6px;background:var(--jazer-cyan);color:#000;font-weight:800}

    .compare-small{font-size:14px}
    .compare-medium{font-size:16px}
    .compare-large{font-size:20px}

    @media(max-width:768px){.main-grid{grid-template-columns:1fr}.toolbar{flex-wrap:wrap}}

    @keyframes glowPulse{0%{box-shadow:0 0 10px rgba(0,242,234,.06)}50%{box-shadow:0 0 25px rgba(0,242,234,.12)}100%{box-shadow:0 0 10px rgba(0,242,234,.06)}}
    .btn-animated{animation:glowPulse 3s ease-in-out infinite}
  </style>
</head>
<body>
  <div class="container">
    <a href="index.html" class="back-button" aria-label="Back to utilities">← Back</a>

    <header class="hero" role="banner">
      <h1>Text Utilities</h1>
      <p>Interactive playground with text utilities, presets, accessibility checks, export/import, and extensive examples. Use the controls to refine typography and preview live results.</p>
    </header>

    <div class="main-grid">
      <main>
        <section class="panel">
          <div class="panel-header">
            <div class="panel-title">Live Preview</div>
            <div class="toolbar" role="toolbar" aria-label="Preview toolbar">
              <button class="btn" id="resetBtn">Reset</button>
              <button class="btn" id="copyHtmlBtn">Copy HTML</button>
              <button class="btn btn-primary btn-animated" id="downloadBtn">Download</button>
            </div>
          </div>

          <div class="panel-content demo-area">
            <div class="demo-preview" id="demoPreview" tabindex="0" aria-live="polite">
              <div class="text-sample" id="textSample">
                <div class="text-title" id="sampleTitle">Design Systems & Components</div>
                <div class="text-leadin" id="sampleLeadin">Build consistent UI components with accessible typography, spacing, and text utilities.</div>
                <div class="text-paragraph" id="sampleParagraph">Use utility classes to quickly apply text styles like uppercase, muted, gradients, and more. Adjust live controls to see how letter-spacing, line-height, word-spacing and color affect readability. Try presets and copy HTML for quick reuse across projects.</div>
                <ul id="sampleList"><li>Interactive controls</li><li>Presets & variants</li><li>Keyboard accessible</li></ul>
              </div>
            </div>

            <div style="display:flex;gap:.75rem;flex-wrap:wrap;align-items:center;">
              <label class="control-label" for="sampleTextSelect">Sample</label>
              <select id="sampleTextSelect" aria-label="Sample text select">
                <option value="default">Article Lead</option>
                <option value="code">Code Snippet</option>
                <option value="title">Title</option>
                <option value="caption">Caption</option>
                <option value="paragraph">Long Paragraph</option>
                <option value="social">Social CTA</option>
                <option value="meta">Metadata</option>
                <option value="quote">Pull Quote</option>
              </select>

              <label class="control-label">Font</label>
              <select id="fontSelect" aria-label="Font select">
                <option value="var(--font-body)">Body (Default)</option>
                <option value="var(--font-primary)">Nunito (Headings)</option>
                <option value="var(--font-secondary)">Outfit (UI)</option>
                <option value="'Courier New', monospace">Monospace</option>
              </select>

              <label class="control-label">Apply utility</label>
              <select id="applyClassSelect" aria-label="Apply class select">
                <option value="">-- none --</option>
              </select>

              <button class="btn" id="applyBtn">Apply</button>
            </div>

            <div style="display:flex;gap:.6rem;flex-wrap:wrap;margin-top:.75rem;align-items:center;">
              <div style="display:flex;flex-direction:column;gap:.4rem;"><label class="control-label">Font Size</label><input type="range" id="fontSizeRange" min="12" max="48" value="16" aria-label="Font size" /></div>
              <div style="display:flex;flex-direction:column;gap:.4rem;"><label class="control-label">Line Height</label><input type="range" id="lineHeightRange" min="110" max="200" value="160" aria-label="Line height" /></div>
              <div style="display:flex;flex-direction:column;gap:.4rem;"><label class="control-label">Letter Spacing</label><input type="range" id="letterSpacingRange" min="-2" max="10" value="0" aria-label="Letter spacing" /></div>
              <div style="display:flex;flex-direction:column;gap:.4rem;"><label class="control-label">Word Spacing</label><input type="range" id="wordSpacingRange" min="0" max="24" value="0" aria-label="Word spacing" /></div>
              <div style="display:flex;flex-direction:column;gap:.4rem;"><label class="control-label">Indent (px)</label><input type="range" id="textIndentRange" min="0" max="80" value="0" aria-label="Text indent" /></div>
            </div>

            <div style="display:flex;gap:.75rem;flex-wrap:wrap;margin-top:1rem;align-items:center;">
              <label class="control-label">Color</label><input type="color" id="colorPicker" value="#00f2ea" aria-label="Pick text color" />
              <label class="control-label">Background</label><input type="color" id="bgPicker" value="#0b0b0b" aria-label="Pick background" />
              <label class="control-label">Word wrap</label><select id="wrapSelect" aria-label="Wrap select"><option value="wrap">wrap</option><option value="nowrap">nowrap</option></select>
              <label class="control-label">Text Align</label><select id="alignSelect" aria-label="Align select"><option value="left">left</option><option value="center">center</option><option value="right">right</option><option value="justify">justify</option></select>
              <label class="control-label">Effects</label>
              <div style="display:flex;gap:.4rem;align-items:center;"><label><input type="checkbox" id="enableGradient" /> gradient</label><label><input type="checkbox" id="enableNeon" /> neon</label><label><input type="checkbox" id="enableShadow" /> shadow</label></div>
            </div>

            <div style="display:flex;gap:.5rem;margin-top:.9rem;">
              <button class="btn" id="sampleCopyBtn">Copy Preview Text</button>
              <button class="btn" id="sampleHtmlCopyBtn">Copy Preview HTML</button>
              <button class="btn" id="sampleResetBtn">Reset Preview Styles</button>
            </div>
          </div>
        </section>

        <section class="panel" style="margin-top:1rem;">
          <div class="panel-header"><div class="panel-title">All Utilities</div></div>
          <div class="panel-content">
            <div class="variants-grid" id="variantsGrid"></div>
            <div style="margin-top:1rem; display:flex; gap:.6rem; flex-wrap:wrap;">
              <button class="btn" id="expandVariantsBtn">Expand all utilities</button>
              <button class="btn" id="compressVariantsBtn">Compress view</button>
            </div>
          </div>
        </section>

        <section class="panel" style="margin-top:1rem;">
          <div class="panel-header"><div class="panel-title">Cheat Sheet & Examples</div></div>
          <div class="panel-content cheatsheet" id="cheatsheet"></div>
        </section>

        <section class="panel" style="margin-top:1rem;" aria-label="Comparison">
          <div class="panel-header"><div class="panel-title">Comparison Views</div></div>
          <div class="panel-content" style="display:grid;grid-template-columns:1fr 1fr;gap:.75rem;">
            <div style="background:rgba(0,0,0,.36);padding:.85rem;border-radius:8px;">
              <div class="text-title">Heading Comparison</div>
              <div class="text-paragraph text-muted">Applied classes render for headings.</div>
              <div style="margin-top:.6rem;" id="comparison1">Preview heading applied with the chosen classes and styles.</div>
            </div>
            <div style="background:rgba(0,0,0,.36);padding:.85rem;border-radius:8px;">
              <div class="text-title">Body Copy Comparison</div>
              <div class="text-paragraph text-muted">Applied classes render for body copy.</div>
              <div style="margin-top:.6rem;" id="comparison2">This is a body copy sample used for comparisons; it helps to evaluate line-height, spacing and contrast with different classes applied.</div>
            </div>
          </div>
        </section>

        <section class="panel" style="margin-top:1rem;">
          <div class="panel-header"><div class="panel-title">Accessibility & Contrast Tools</div></div>
          <div class="panel-content">
            <div class="control-row"><div><div class="control-label">Contrast analyzer</div><div class="text-small text-muted">Checks foreground vs background</div></div><div id="contrastResult">Contrast: --</div></div>
            <div class="control-row"><div class="control-label">WCAG AA/AAA</div><div id="wcagResult">--</div></div>
            <div class="control-row"><div class="control-label">Text size accessibility</div><div class="text-small text-muted">Try increasing font scale</div></div>
            <div style="margin-top:.6rem;display:flex;gap:.5rem;align-items:center;"><button class="btn" id="runA11yBtn">Run A11y Quick Check</button><button class="btn" id="openA11yReport">Open report</button></div>
          </div>
        </section>

        <section class="panel" style="margin-top:1rem;">
          <div class="panel-header"><div class="panel-title">FAQ & Usage</div></div>
          <div class="panel-content" id="faqContent">
            <div style="margin-bottom:.6rem;"><strong>How do I use utility classes?</strong><div class="text-muted">Select a utility from the dropdown or the grid and apply it to the live preview. Use presets for common patterns.</div></div>
            <div style="margin-bottom:.6rem;"><strong>Exporting</strong><div class="text-muted">Use export to copy a CSS snippet or download the generated CSS. Save presets to reuse later.</div></div>
            <div style="margin-bottom:.6rem;"><strong>Accessibility</strong><div class="text-muted">Use the contrast analyzer to ensure WCAG compliance. Increase line height and letter spacing for better readability.</div></div>
          </div>
        </section>

      </main>

      <aside class="controls-panel">
        <details open>
          <summary>Presets</summary>
          <div class="details-content">
            <div style="display:flex;gap:.6rem;flex-wrap:wrap;">
              <button class="btn" data-preset="default">Default</button>
              <button class="btn" data-preset="heading">Heading</button>
              <button class="btn" data-preset="subtitle">Subtitle</button>
              <button class="btn" data-preset="paragraph">Paragraph</button>
              <button class="btn" data-preset="caption">Caption</button>
              <button class="btn" data-preset="code">Code Block</button>
            </div>
            <div style="margin-top:.75rem;display:flex;gap:.6rem;align-items:center;">
              <input type="text" id="newPresetName" placeholder="Preset name" style="flex:1;padding:.5rem;border-radius:8px;border:1px solid var(--border-default);background:transparent;color:var(--text-light)" />
              <button class="btn" id="savePresetBtn">Save Preset</button>
            </div>
            <div id="savedPresets" style="margin-top:.6rem"></div>
          </div>
        </details>

        <details>
          <summary>Accessibility</summary>
          <div class="details-content">
            <div class="control-row"><div><div class="control-label">Minimum Contrast</div><div class="text-small text-muted">Quick toggle for contrast enforcement</div></div><label class="toggle-switch"><input type="checkbox" id="enforceContrast"><span class="toggle-slider"></span></label></div>
            <div class="control-row"><div class="control-label">Increase font scale</div><input type="range" id="fontScale" min="0" max="1" step=".1" value="0" /></div>
            <div style="margin-top:.6rem"><div class="control-label">Contrast analyzer</div><div id="contrastDetail" class="text-small text-muted">Contrast results shown live</div></div>
            <div style="margin-top:.6rem"><button class="btn" id="toggleBgBtn">Toggle Light/Dark</button></div>
          </div>
        </details>

        <details>
          <summary>Helpers</summary>
          <div class="details-content">
            <div class="control-row"><div class="control-label">Toggle .text-ellipsis</div><button class="btn" id="toggleEllipsis">Toggle</button></div>
            <div class="control-row"><div class="control-label">Toggle .text-mono</div><button class="btn" id="toggleMono">Toggle</button></div>
            <div class="control-row"><div class="control-label">Small Caps</div><button class="btn" id="toggleSmallCaps">Toggle</button></div>
            <div style="margin-top:.5rem;display:flex;gap:.4rem"><button class="btn" id="exportCssBtn">Export current CSS</button><button class="btn" id="downloadCssBtn">Download CSS</button></div>
          </div>
        </details>

        <details>
          <summary>History</summary>
          <div class="details-content" id="historyPanel">
            <div id="historyList">No history yet</div>
            <div style="display:flex;gap:.5rem;margin-top:.6rem;"><button class="btn" id="clearHistoryBtn">Clear</button><button class="btn" id="importPresetsBtn">Import</button></div>
          </div>
        </details>

        <details>
          <summary>Keyboard Shortcuts</summary>
          <div class="details-content">
            <div style="display:grid;gap:.4rem;">
              <div class="text-small text-muted">Ctrl+Shift+C — Copy Preview Text</div>
              <div class="text-small text-muted">Ctrl+Shift+H — Toggle History Panel</div>
              <div class="text-small text-muted">Alt+1 — Apply default preset</div>
              <div class="text-small text-muted">Alt+2 — Apply heading preset</div>
              <div class="text-small text-muted">Alt+G — Toggle gradient</div>
              <div class="text-small text-muted">Ctrl+Z / Ctrl+Shift+Z — Undo / Redo</div>
            </div>
          </div>
        </details>

        <div style="margin-top:1rem;display:flex;gap:.5rem;">
          <button class="btn" id="exportBtn">Export CSS classes</button>
          <button class="btn" id="inspectBtn">Inspect applied</button>
        </div>
      </aside>
    </div>

    <footer class="status-bar" role="status">
      <div class="status-items">
        <div class="status-item">Chars <span class="status-value" id="statChars">0</span></div>
        <div class="status-item">Words <span class="status-value" id="statWords">0</span></div>
        <div class="status-item">Classes <span class="status-value" id="statClasses">0</span></div>
        <div class="status-item">Contrast <span class="status-value" id="statContrast">--</span></div>
      </div>
      <div class="status-items"><div class="status-item">Last <span class="status-value" id="statLast">Ready</span></div><div class="status-item"><button class="btn" id="openDocsBtn">Docs</button></div></div>
    </footer>

    <div id="modal" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,.6);align-items:center;justify-content:center;z-index:9999">
      <div id="modalContent" style="background:var(--bg-card);border:2px solid var(--border-default);padding:1.25rem;border-radius:8px;width:min(1100px,92%);max-height:90vh;overflow:auto"></div>
    </div>
  </div>

  <script>
    const state={classes:new Set(),history:[],maxHistory:100,presets:{},undoStack:[],redoStack:[],lightBg:false};

    const samples={default:{title:'Design Systems & Components',leadin:'Build consistent UI components with accessible typography, spacing, and text utilities.',paragraph:'Use utility classes to quickly apply text styles like uppercase, muted, gradients, and more. Adjust live controls to see how letter-spacing, line-height, word-spacing and color affect readability.'},code:{title:"const system = {",leadin:"  name: 'JaZeR',",paragraph:"  theme: 'cyberpunk'\n};"},title:{title:'The Future of Design Systems',leadin:'A short, punchy subtitle',paragraph:'This is an example title and the paragraph will be short to test heading hierarchy.'},caption:{title:'Image caption',leadin:'Small caption with muted styling',paragraph:'Helpful for microcopy.'},paragraph:{title:'Long Paragraph Example',leadin:'Lead-in text for long paragraph testing',paragraph:'This is a longer paragraph used to test truncation, ellipses and responsive behavior. It should wrap, be easily readable, and respond to changes in letter spacing and line height.'},social:{title:'Share this moment',leadin:'A small CTA designed for social platforms',paragraph:'Short headline and a small call to action.'},meta:{title:'By Alex • 22 Jun',leadin:'Meta information example',paragraph:'Informational metadata with small text.'},quote:{title:'"Design is thinking made visible."',leadin:'— Saul Bass',paragraph:'A pull quote designed to test style and spacing.'}};

    const demo=document.getElementById('demoPreview');
    const textSample=document.getElementById('textSample');
    const sampleTitle=document.getElementById('sampleTitle');
    const sampleLeadin=document.getElementById('sampleLeadin');
    const sampleParagraph=document.getElementById('sampleParagraph');
    const sampleList=document.getElementById('sampleList');
    const sampleSelect=document.getElementById('sampleTextSelect');
    const fontSelect=document.getElementById('fontSelect');
    const applyClassSelect=document.getElementById('applyClassSelect');
    const applyBtn=document.getElementById('applyBtn');
    const resetBtn=document.getElementById('resetBtn');
    const copyHtmlBtn=document.getElementById('copyHtmlBtn');
    const downloadBtn=document.getElementById('downloadBtn');
    const variantsGrid=document.getElementById('variantsGrid');
    const colorPicker=document.getElementById('colorPicker');
    const bgPicker=document.getElementById('bgPicker');
    const fontSizeRange=document.getElementById('fontSizeRange');
    const lineHeightRange=document.getElementById('lineHeightRange');
    const letterSpacingRange=document.getElementById('letterSpacingRange');
    const wordSpacingRange=document.getElementById('wordSpacingRange');
    const textIndentRange=document.getElementById('textIndentRange');
    const wrapSelect=document.getElementById('wrapSelect');
    const alignSelect=document.getElementById('alignSelect');
    const enableGradient=document.getElementById('enableGradient');
    const enableNeon=document.getElementById('enableNeon');
    const enableShadow=document.getElementById('enableShadow');
    const statChars=document.getElementById('statChars');
    const statWords=document.getElementById('statWords');
    const statClasses=document.getElementById('statClasses');
    const statLast=document.getElementById('statLast');
    const statContrast=document.getElementById('statContrast');
    const statContrastText=document.getElementById('contrastResult');
    const sampleCopyBtn=document.getElementById('sampleCopyBtn');
    const sampleHtmlCopyBtn=document.getElementById('sampleHtmlCopyBtn');
    const sampleResetBtn=document.getElementById('sampleResetBtn');
    const historyList=document.getElementById('historyList');
    const clearHistoryBtn=document.getElementById('clearHistoryBtn');
    const savedPresetsEl=document.getElementById('savedPresets');
    const newPresetName=document.getElementById('newPresetName');
    const savePresetBtn=document.getElementById('savePresetBtn');
    const comparison1=document.getElementById('comparison1');
    const comparison2=document.getElementById('comparison2');
    const cheatsheetEl=document.getElementById('cheatsheet');

    const utils=[
      {class:'text-uppercase',name:'Uppercase',example:'We are the future.'},
      {class:'text-lowercase',name:'Lowercase',example:'We Are THE FUTURE'},
      {class:'text-capitalize',name:'Capitalize',example:'we are the future'},
      {class:'text-muted',name:'Muted',example:'Less emphasis'},
      {class:'text-accent',name:'Accent',example:'Stand out'},
      {class:'text-mono',name:'Monospace',example:'Code Snippet: const a = 10;'},
      {class:'text-ellipsis',name:'Ellipsis',example:'This is a very long piece of text that will be truncated by ellipsis.'},
      {class:'text-truncate-2',name:'Truncate 2 lines',example:'Two lines only. This should be cut after two lines.'},
      {class:'text-truncate-3',name:'Truncate 3 lines',example:'Three lines only. This example will show three lines then hide the rest.'},
      {class:'text-center',name:'Center',example:'Centered text'},
      {class:'text-right',name:'Right Align',example:'Aligned to the right'},
      {class:'text-strong',name:'Strong',example:'Bold weight'},
      {class:'text-light',name:'Light',example:'Thin weight'},
      {class:'text-gradient',name:'Gradient Text',example:'Gradient applied'},
      {class:'text-neon',name:'Neon Glow',example:'Neon effect'},
      {class:'text-shadow',name:'Shadow',example:'Shadow example'},
      {class:'text-underline',name:'Underline',example:'Underline example'},
      {class:'text-overline',name:'Overline',example:'Overline example'},
      {class:'text-strike',name:'Strikethrough',example:'Strike example'},
      {class:'text-highlight',name:'Highlight',example:'Highlighted text'},
      {class:'text-dropcap',name:'Drop Cap',example:'This paragraph starts with a styled drop cap applied to the first letter.'},
      {class:'text-danger',name:'Danger',example:'Danger color'},
      {class:'text-success',name:'Success',example:'Success color'},
      {class:'text-warning',name:'Warning',example:'Warning color'},
      {class:'text-info',name:'Info',example:'Info color'},
      {class:'text-link',name:'Link',example:'A link which is underlined'},
      {class:'text-outline',name:'Outline',example:'Outlined text style'},
      {class:'text-outline-strong',name:'Outline Strong',example:'Thicker outline'},
      {class:'text-ghost',name:'Ghost',example:'Subtle ghost text'},
      {class:'text-inverse',name:'Inverse',example:'Inverse style'},
      {class:'text-gradient-accent',name:'Gradient Accent',example:'Cyan to pink gradient'},
      {class:'text-gradient-vertical',name:'Gradient Vertical',example:'Vertical gradient text'},
      {class:'text-outline-light',name:'Outline Light',example:'Light outline subtle'},
      {class:'text-cta',name:'CTA',example:'Call to action'},
      {class:'text-subtle',name:'Subtle',example:'Subtle emphasis'},
      {class:'text-muted-alt',name:'Muted Alt',example:'Alternative muted color'},
      {class:'text-faint',name:'Faint',example:'Very faint text'},
      {class:'text-gradient-accent-2',name:'Gradient Accent 2',example:'Alternate gradient'},
      {class:'text-readability',name:'Readability',example:'Designed for maximum readability'},
      {class:'text-acc-aria',name:'Accessible',example:'Accessible text emphasis'},
      {class:'text-ghost-subtle',name:'Ghost Subtle',example:'Even more faint text'},
      {class:'text-heavy',name:'Heavy',example:'Very heavy weight'},
      {class:'text-display',name:'Display',example:'Large display heading'},
      {class:'text-caption',name:'Caption',example:'Small caption text'},
      {class:'text-sans',name:'Sans',example:'Sans font utility'},
      {class:'text-serif',name:'Serif',example:'Serif font utility'},
      {class:'text-variable',name:'Variable',example:'Variable font sample'},
      {class:'text-normal',name:'Normal',example:'Reset to normal'},
      {class:'text-strong-accent',name:'Strong Accent',example:'Strong accent style'},
      {class:'text-soft',name:'Soft',example:'Soft subtle text'},
      {class:'text-emphasis',name:'Emphasis',example:'Emphasized text'},
      {class:'text-supersede',name:'Supersede',example:'Supersede minor difference'},
      {class:'text-lowercase-alt',name:'LC Alt',example:'lowercase alt example'},
      {class:'text-weight-500',name:'Weight 500',example:'Medium weight'},
      {class:'text-weight-300',name:'Weight 300',example:'Light weight'},
      {class:'text-button',name:'Button Text',example:'Button label'},
      {class:'text-meta',name:'Metadata',example:'Byline and metadata'},
      {class:'text-inline-code',name:'Inline Code',example:'const a = 10;'},
      {class:'text-number',name:'Numeric',example:'1,234.56'},
      {class:'text-percent',name:'Percent',example:'50%'}
    ];

    const cheatCards=[
      {title:'Uppercase',snippet:'<p class="text-uppercase">HELLO</p>'},
      {title:'Gradient',snippet:'<h1 class="text-gradient">Title</h1>'},
      {title:'Ellipsis',snippet:'<p class="text-ellipsis">Long text that will be truncated with an ellipsis</p>'},
      {title:'Drop Cap',snippet:'<p class="text-dropcap">This begins with a drop cap</p>'},
      {title:'Monospace',snippet:'<code class="text-mono">const a = 10;</code>'},
      {title:'Danger',snippet:'<p class="text-danger">Danger</p>'},
      {title:'Muted',snippet:'<p class="text-muted">Less emphasis</p>'},
      {title:'Underline',snippet:'<p class="text-underline">Underlined</p>'},
      {title:'Highlight',snippet:'<p class="text-highlight">Highlighted</p>'},
      {title:'Neon',snippet:'<span class="text-neon">Neon text</span>'},
      {title:'Shadow',snippet:'<p class="text-shadow">Shadow effect</p>'},
      {title:'CTA',snippet:'<button class="text-cta">Action</button>'},
      {title:'Inline Code',snippet:'<span class="text-inline-code">console.log(\'test\')</span>'},
      {title:'Metadata',snippet:'<small class="text-meta">By Author • 3 mins read</small>'},
      {title:'Badge',snippet:'<span class="text-cta">NEW</span>'},
      {title:'Display',snippet:'<h1 class="text-display">Big display</h1>'}
    ];

    function renderVariants(){
      variantsGrid.innerHTML=utils.map(u=>`<div class=\"variant-card\" data-class=\"${u.class}\"><div style=\"display:flex;justify-content:space-between;align-items:center\"><div class=\"variant-name\">${u.name}</div><div class=\"variant-tag\">${u.class}</div></div><div class=\"variant-example ${u.class}\">${u.example}</div><div class=\"variant-desc\">Try ${u.class} in the live preview to test readability and spacing.</div><div class=\"variant-actions\"><button class=\"btn apply-variant\" data-class=\"${u.class}\">Apply</button><button class=\"btn copy-variant\" data-class=\"${u.class}\">Copy</button></div></div>`).join('');

      document.querySelectorAll('.apply-variant').forEach(btn=>btn.addEventListener('click',e=>{const cls=e.currentTarget.dataset.class;toggleClassOnSample(cls);setLast(`Applied ${cls}`);saveHistory('Applied '+cls);}));
      document.querySelectorAll('.copy-variant').forEach(btn=>btn.addEventListener('click',e=>{const cls=e.currentTarget.dataset.class;const el=document.querySelector(`.variant-example.${cls}`);copyToClipboard(el?`<p class=\"${cls}\">${el.textContent}</p>`:`<p class=\"${cls}\">Example</p>`);setLast(`Copied ${cls}`);}));

      // Populate applyClassSelect for quick apply
      applyClassSelect.innerHTML = '<option value="">-- none --</option>' + utils.map(u=>`<option value=\"${u.class}\">${u.class}</option>`).join('');
    }

    function renderCheatsheet(){
      cheatsheetEl.innerHTML=cheatCards.map(c=>`<div class=\"cheat-card\"><strong>${c.title}</strong><div style=\"margin-top:.35rem;font-family:monospace;white-space:pre\">${c.snippet.replace(/</g,'&lt;')}</div></div>`).join('');
    }

    function applyPreset(p){const pinned=samples[p];if(!pinned)return;sampleTitle.textContent=pinned.title||'';sampleLeadin.textContent=pinned.leadin||'';sampleParagraph.textContent=pinned.paragraph||'';updateComparison();updateStats();setLast(`Preset ${p} applied`)}

    function setLast(msg){statLast.textContent=msg;setTimeout(()=>{if(statLast.textContent===msg)statLast.textContent='Ready';},2200)}

    function updateStats(){const t=(sampleTitle.textContent+' '+(sampleParagraph.textContent||'')).trim();statChars.textContent=t.length;statWords.textContent=t.split(/\s+/).filter(Boolean).length;statClasses.textContent=state.classes.size}

    function toggleClassOnSample(cls){if(!cls)return; if(textSample.classList.contains(cls)){textSample.classList.remove(cls);state.classes.delete(cls)}else{textSample.classList.add(cls);state.classes.add(cls)}pushState();updateComparison();updateStats()}

    function applyColor(c){textSample.style.color=c;updateContrast();updateStats()}
    function applyBgColor(c){document.body.style.background=c;updateContrast()}
    function applyFont(f){textSample.style.fontFamily=f;updateStats()}
    function applyNumericStyles(){const fs=parseInt(fontSizeRange.value,10);const lh=parseInt(lineHeightRange.value,10)/100;const ls=parseInt(letterSpacingRange.value,10)/10;const ws=parseInt(wordSpacingRange.value,10);const indent=parseInt(textIndentRange.value,10);textSample.style.fontSize=fs+'px';textSample.style.lineHeight=lh;textSample.style.letterSpacing=ls+'px';textSample.style.wordSpacing=ws+'px';textSample.style.textIndent=indent+'px';pushState();updateComparison();updateStats();}

    function copyPreviewText(){copyToClipboard(textSample.textContent.trim());setLast('Preview text copied');saveHistory('Copied preview text')}
    function copyPreviewHtml(){copyToClipboard(textSample.outerHTML);setLast('Preview HTML copied');saveHistory('Copied preview HTML')}
    function copyToClipboard(text){if(!navigator.clipboard)return;navigator.clipboard.writeText(text).catch(()=>{})}

    function downloadHTML(){const html='<!-- Text Utilities Preview -->\n'+textSample.outerHTML;const blob=new Blob([html],{type:'text/html'});const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download='text-utilities-preview.html';document.body.appendChild(a);a.click();document.body.removeChild(a);URL.revokeObjectURL(url);setLast('Downloaded preview');saveHistory('Downloaded preview')}

    function generateCssFromClasses(){const clsArr=Array.from(state.classes);let css='/* Generated CSS for classes: '+clsArr.join(', ')+' */\n';clsArr.forEach(c=>{css+=`.${c}{/* add styles or reference this class in your project */}\n`});copyToClipboard(css);setLast('CSS copied');}
    function downloadCss(){const snippet='.jzr-text-utility{'+(textSample.getAttribute('style')||'')+'}';const blob=new Blob([snippet],{type:'text/css'});const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download='jzr-text-utility.css';document.body.appendChild(a);a.click();document.body.removeChild(a);URL.revokeObjectURL(url);setLast('CSS downloaded');}

    function resetPreview(){textSample.removeAttribute('style');textSample.className='text-sample';state.classes.clear();[fontSizeRange,lineHeightRange,letterSpacingRange,wordSpacingRange,textIndentRange].forEach(el=>{if(el.type==='range')el.value=el.defaultValue||el.getAttribute('value')||el.min});colorPicker.value='#00f2ea';bgPicker.value='#0b0b0b';enableGradient.checked=false;enableNeon.checked=false;enableShadow.checked=false;pushState();setLast('Reset preview');updateStats();saveHistory('Reset preview')}

    function exportClasses(){copyToClipboard(Array.from(state.classes).join(' '));setLast('Exported classes');saveHistory('Exported classes')}
    function toggleSmallCaps(){textSample.style.fontVariantCaps=textSample.style.fontVariantCaps==='small-caps'?'':'small-caps';pushState();updateStats()}
    function toggleMonospace(){toggleClassOnSample('text-mono')}
    function toggleEllipsis(){toggleClassOnSample('text-ellipsis')}

    function saveHistory(action){state.history.unshift({action,timestamp:new Date().toLocaleString(),classes:Array.from(state.classes),styles:textSample.getAttribute('style')||''});if(state.history.length>state.maxHistory)state.history.pop();localStorage.setItem('textUtilitiesHistory',JSON.stringify(state.history));renderHistory()}
    function loadHistory(){const s=localStorage.getItem('textUtilitiesHistory');if(!s)return;state.history=JSON.parse(s);renderHistory()}
    function renderHistory(){if(!state.history.length){historyList.innerHTML='<div class="text-muted">No history yet</div>';return}historyList.innerHTML=state.history.map((h,i)=>`<div style=\"padding:.5rem;border-bottom:1px solid var(--border-default);display:flex;justify-content:space-between;gap:.6rem\"><div><strong>${h.action}</strong><div class=\"text-small text-muted\">${h.timestamp}</div></div><div><button class=\"btn\" data-index=\"${i}\">Apply</button></div></div>`).join('');historyList.querySelectorAll('button[data-index]').forEach(btn=>btn.addEventListener('click',e=>{const idx=parseInt(e.currentTarget.dataset.index,10);const entry=state.history[idx];if(!entry)return;textSample.className='text-sample '+entry.classes.join(' ');if(entry.styles)textSample.setAttribute('style',entry.styles);updateStats();setLast('Applied from history');}))}
    function clearHistory(){state.history=[];localStorage.removeItem('textUtilitiesHistory');renderHistory();setLast('History cleared')}

    function savePreset(){const name=(newPresetName.value||'').trim();if(!name){setLast('Preset name required');return}const preset={classes:Array.from(state.classes),styles:textSample.getAttribute('style')||''};state.presets[name]=preset;localStorage.setItem('textUtilitiesPresets',JSON.stringify(state.presets));renderPresetList();setLast(`Saved preset ${name}`)}
    function loadPresets(){const s=localStorage.getItem('textUtilitiesPresets');if(!s)return;state.presets=JSON.parse(s);renderPresetList()}
    function renderPresetList(){if(!Object.keys(state.presets).length){savedPresetsEl.innerHTML='<div class="text-muted">No presets saved</div>';return}savedPresetsEl.innerHTML=Object.keys(state.presets).map(k=>`<div style=\"display:flex;justify-content:space-between;align-items:center;gap:.5rem;padding:.35rem 0\"><div><strong>${k}</strong><div class=\"text-small text-muted\">${state.presets[k].classes.join(' ')}</div></div><div><button class=\"btn load-preset\" data-name=\"${k}\">Load</button><button class=\"btn\" style=\"margin-left:.4rem;\" data-name=\"${k}\" data-action=\"delete\">Del</button></div></div>`).join('');document.querySelectorAll('.load-preset').forEach(btn=>btn.addEventListener('click',e=>applyPresetFromStore(e.currentTarget.dataset.name)));document.querySelectorAll('button[data-action=delete]').forEach(btn=>btn.addEventListener('click',e=>{const name=e.currentTarget.dataset.name;delete state.presets[name];localStorage.setItem('textUtilitiesPresets',JSON.stringify(state.presets));renderPresetList();setLast(`Deleted preset ${name}`)}))}
    function applyPresetFromStore(name){const p=state.presets[name];if(!p)return;textSample.className='text-sample '+p.classes.join(' ');if(p.styles)textSample.setAttribute('style',p.styles);updateStats();setLast('Loaded preset '+name)}

    function getInlineStyles(){return textSample.getAttribute('style')||''}

    function exportPresets(){const blob=new Blob([JSON.stringify(state.presets,null,2)],{type:'application/json'});const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download='text-utilities-presets.json';document.body.appendChild(a);a.click();document.body.removeChild(a);URL.revokeObjectURL(url);setLast('Presets exported')}
    function importPresets(file){if(!file)return;const reader=new FileReader();reader.onload=e=>{try{const data=JSON.parse(e.target.result);Object.assign(state.presets,data);localStorage.setItem('textUtilitiesPresets',JSON.stringify(state.presets));renderPresetList();setLast('Presets imported')}catch(err){setLast('Import failed')}};reader.readAsText(file)}
    function attachFileImport(){const input=document.createElement('input');input.type='file';input.accept='application/json';input.onchange=e=>{const f=e.target.files[0];if(f)importPresets(f)};input.click()}

    function computeLuminance(hex){hex=hex.replace('#','');const r=parseInt(hex.slice(0,2),16)/255;const g=parseInt(hex.slice(2,4),16)/255;const b=parseInt(hex.slice(4,6),16)/255;const srgb=[r,g,b].map(c=>c<=.03928?c/12.92:Math.pow((c+.055)/1.055,2.4));return 0.2126*srgb[0]+0.7152*srgb[1]+0.0722*srgb[2]}
    function contrastRatio(hex1,hex2){const l1=computeLuminance(hex1.replace('#',''));const l2=computeLuminance(hex2.replace('#',''));const lighter=Math.max(l1,l2);const darker=Math.min(l1,l2);return(lighter+.05)/(darker+.05)}

    function updateContrast(){const fg=colorPicker.value||'#00f2ea';const bg=bgPicker.value||'#0b0b0b';const ratio=contrastRatio(fg,bg);statContrast.textContent=ratio.toFixed(2);const pass=ratio>=4.5?'Pass':'Fail';statContrastText.textContent=`Contrast: ${ratio.toFixed(2)} — ${pass}`;if(state.enforceContrast&&ratio<4.5){setLast('Contrast fail');}return{ratio,pass}}
    function toggleBg(){state.lightBg=!state.lightBg;document.body.style.background=state.lightBg?'#fff':'var(--bg-dark)';document.body.style.color=state.lightBg?'#111827':'var(--text-light)';updateContrast()}

    function pushState(){state.undoStack.push({classes:Array.from(state.classes),styles:textSample.getAttribute('style')||''});if(state.undoStack.length>200)state.undoStack.shift();state.redoStack=[]}
    function undo(){if(!state.undoStack.length)return;const s=state.undoStack.pop();state.redoStack.push({classes:Array.from(state.classes),styles:textSample.getAttribute('style')||''});textSample.className='text-sample '+(s.classes||[]).join(' ');if(s.styles)textSample.setAttribute('style',s.styles);updateStats();setLast('Undo')}
    function redo(){if(!state.redoStack.length)return;const s=state.redoStack.pop();state.undoStack.push({classes:Array.from(state.classes),styles:textSample.getAttribute('style')||''});textSample.className='text-sample '+(s.classes||[]).join(' ');if(s.styles)textSample.setAttribute('style',s.styles);updateStats();setLast('Redo')}

    function initControls(){applyBtn.addEventListener('click',()=>{const cls=applyClassSelect.value;if(cls)toggleClassOnSample(cls);setLast(cls?`Toggled ${cls}`:'No class selected');saveHistory('Applied class '+cls)});resetBtn.addEventListener('click',()=>resetPreview());copyHtmlBtn.addEventListener('click',()=>copyPreviewHtml());downloadBtn.addEventListener('click',()=>downloadHTML());sampleSelect.addEventListener('change',e=>applyPreset(e.target.value));fontSelect.addEventListener('change',e=>applyFont(e.target.value));colorPicker.addEventListener('input',e=>applyColor(e.target.value));bgPicker.addEventListener('input',e=>applyBgColor(e.target.value));fontSizeRange.addEventListener('input',applyNumericStyles);lineHeightRange.addEventListener('input',applyNumericStyles);letterSpacingRange.addEventListener('input',applyNumericStyles);wordSpacingRange.addEventListener('input',applyNumericStyles);textIndentRange.addEventListener('input',applyNumericStyles);wrapSelect.addEventListener('change',()=>{textSample.style.whiteSpace=wrapSelect.value==='nowrap'?'nowrap':'normal';updateStats()});alignSelect.addEventListener('change',()=>{textSample.style.textAlign=alignSelect.value;updateStats()});enableGradient.addEventListener('change',()=>{enableGradient.checked?textSample.classList.add('text-gradient'):textSample.classList.remove('text-gradient');updateStats()});enableNeon.addEventListener('change',()=>{enableNeon.checked?textSample.classList.add('text-neon'):textSample.classList.remove('text-neon');updateStats()});enableShadow.addEventListener('change',()=>{enableShadow.checked?textSample.classList.add('text-shadow'):textSample.classList.remove('text-shadow');updateStats()});sampleCopyBtn.addEventListener('click',()=>copyPreviewText());sampleHtmlCopyBtn.addEventListener('click',()=>copyPreviewHtml());sampleResetBtn.addEventListener('click',()=>resetPreview());document.getElementById('toggleEllipsis').addEventListener('click',()=>toggleEllipsis());document.getElementById('toggleMono').addEventListener('click',()=>toggleMonospace());document.getElementById('toggleSmallCaps').addEventListener('click',()=>toggleSmallCaps());document.getElementById('exportBtn').addEventListener('click',()=>exportClasses());document.getElementById('inspectBtn').addEventListener('click',()=>openModal('<h2>Inspect</h2><pre>'+Array.from(state.classes).join(' ')+'</pre>'));document.getElementById('clearHistoryBtn').addEventListener('click',()=>clearHistory());document.getElementById('savePresetBtn').addEventListener('click',()=>savePreset());document.getElementById('toggleBgBtn').addEventListener('click',()=>toggleBg());document.getElementById('exportCssBtn').addEventListener('click',()=>generateCssFromClasses());document.getElementById('downloadCssBtn').addEventListener('click',()=>downloadCss());document.getElementById('importPresetsBtn').addEventListener('click',()=>attachFileImport());document.getElementById('expandVariantsBtn').addEventListener('click',()=>document.querySelectorAll('.variant-card').forEach(c=>c.style.display='block'));document.getElementById('compressVariantsBtn').addEventListener('click',()=>document.querySelectorAll('.variant-card').forEach(c=>c.style.display='none'));

      document.addEventListener('keydown',e=>{if(e.ctrlKey&&e.shiftKey&&e.key.toLowerCase()==='c'){copyPreviewText();e.preventDefault()}if(e.ctrlKey&&e.shiftKey&&e.key.toLowerCase()==='h'){const hist=document.getElementById('historyPanel');hist.scrollIntoView({behavior:'smooth'});e.preventDefault()}if(e.altKey&&e.key==='1')applyPreset('default');if(e.altKey&&e.key==='2')applyPreset('title');if(e.altKey&&e.key.toLowerCase()==='g'){enableGradient.checked=!enableGradient.checked;enableGradient.dispatchEvent(new Event('change'))}if(e.ctrlKey&&e.key==='z'){e.preventDefault();undo()}if(e.ctrlKey&&e.shiftKey&&e.key==='Z'){e.preventDefault();redo()}})
    }

    function pushState(){state.undoStack.push({classes:Array.from(state.classes),styles:textSample.getAttribute('style')||''});if(state.undoStack.length>200)state.undoStack.shift();state.redoStack=[]}
    function loadPresetsOnStart(){loadPresets()}
    function init(){renderVariants();renderCheatsheet();applyPreset('default');loadHistory();loadPresets();initControls();updateStats();updateContrast();renderPresetList();pushState()}
    document.addEventListener('DOMContentLoaded',init);
  </script>
</body>
</html>