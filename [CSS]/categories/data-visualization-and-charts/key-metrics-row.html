<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Key Metrics Row - JaZeR CSS Patterns</title>
    <link rel="stylesheet" href="../../../jazer-brand.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: var(--bg-dark);
            color: var(--text-light);
            font-family: var(--font-body);
            min-height: 100vh;
            padding: 1.5rem;
            padding-bottom: 3rem;
        }

        .back-button {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--jazer-cyan);
            text-decoration: none;
            font-family: var(--font-secondary);
            font-size: 0.9rem;
            font-weight: 500;
            margin-bottom: 1.5rem;
            padding: 0.5rem 0.75rem;
            border-radius: 8px;
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .back-button:hover {
            background: rgba(6, 182, 212, 0.1);
            gap: 0.75rem;
        }

        /* Hero Section */
        .hero {
            text-align: center;
            padding: 2rem 1.5rem;
            margin-bottom: 2rem;
            background: linear-gradient(135deg, rgba(6, 182, 212, 0.08) 0%, rgba(147, 51, 234, 0.08) 50%, rgba(236, 72, 153, 0.08) 100%);
            border-radius: 16px;
            border: 1px solid rgba(6, 182, 212, 0.2);
            position: relative;
            overflow: hidden;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--gradient-primary);
        }

        .hero h1 {
            font-family: var(--font-primary);
            font-size: clamp(1.75rem, 4vw, 2.5rem);
            font-weight: 800;
            background: var(--gradient-text);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
        }

        .hero-description {
            color: var(--text-gray);
            font-size: 1rem;
            max-width: 600px;
            margin: 0 auto;
        }

        /* Main Layout */
        .main-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
            max-width: 1400px;
            margin: 0 auto;
        }

        @media (min-width: 1000px) {
            .main-container {
                grid-template-columns: 1fr 340px;
            }
        }

        /* Panels */
        .panel {
            background: var(--bg-card);
            border: 2px solid var(--border-default);
            border-radius: 16px;
            padding: 1.5rem;
            transition: border-color 0.3s ease;
        }

        .panel:hover {
            border-color: rgba(6, 182, 212, 0.3);
        }

        .panel-title {
            font-family: var(--font-secondary);
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            color: var(--jazer-cyan);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .panel-title::before {
            content: '';
            width: 8px;
            height: 8px;
            background: var(--jazer-cyan);
            border-radius: 50%;
            box-shadow: 0 0 8px var(--jazer-cyan);
        }

        /* Table Container */
        .table-wrapper {
            overflow-x: auto;
            border-radius: 12px;
            border: 1px solid var(--border-default);
            background: rgba(0, 0, 0, 0.3);
        }

        .metrics-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 600px;
        }

        .metrics-table th,
        .metrics-table td {
            padding: 0.875rem 1rem;
            text-align: left;
            border-bottom: 1px solid var(--border-default);
            font-size: 0.85rem;
            transition: all 0.2s ease;
        }

        .metrics-table th {
            background: rgba(6, 182, 212, 0.1);
            font-family: var(--font-secondary);
            font-weight: 600;
            color: var(--text-light);
            text-transform: uppercase;
            font-size: 0.7rem;
            letter-spacing: 1px;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .metrics-table th:first-child {
            border-radius: 12px 0 0 0;
        }

        .metrics-table th:last-child {
            border-radius: 0 12px 0 0;
        }

        .metrics-table tbody tr {
            transition: background 0.2s ease;
        }

        .metrics-table tbody tr:hover:not(.metrics-row) {
            background: rgba(255, 255, 255, 0.03);
        }

        .metrics-table tbody tr:last-child td {
            border-bottom: none;
        }

        .metrics-table td.numeric {
            text-align: right;
            font-family: var(--font-secondary);
            font-variant-numeric: tabular-nums;
        }

        /* Key Metrics Row Styles */
        .metrics-row {
            font-weight: 700;
            position: relative;
        }

        /* Position: Top */
        .metrics-row.position-top td {
            border-bottom: 3px solid var(--jazer-cyan);
        }

        /* Position: Bottom */
        .metrics-row.position-bottom td {
            border-top: 3px solid var(--jazer-cyan);
            border-bottom: none;
        }

        /* Highlight Style: Glow */
        .metrics-row.style-glow {
            background: rgba(6, 182, 212, 0.15);
        }

        .metrics-row.style-glow td {
            color: var(--jazer-cyan);
            text-shadow: 0 0 8px rgba(6, 182, 212, 0.5);
        }

        .metrics-row.style-glow td:first-child {
            background: var(--jazer-cyan);
            color: var(--bg-dark);
            text-shadow: none;
            font-weight: 800;
        }

        /* Highlight Style: Gradient */
        .metrics-row.style-gradient {
            background: linear-gradient(90deg, rgba(6, 182, 212, 0.2), rgba(147, 51, 234, 0.2), rgba(236, 72, 153, 0.2));
        }

        .metrics-row.style-gradient td {
            color: var(--text-light);
        }

        .metrics-row.style-gradient td:first-child {
            background: var(--gradient-primary);
            color: white;
            font-weight: 800;
        }

        /* Highlight Style: Accent */
        .metrics-row.style-accent {
            background: rgba(147, 51, 234, 0.15);
        }

        .metrics-row.style-accent td {
            color: var(--jazer-purple);
            border-color: var(--jazer-purple);
        }

        .metrics-row.style-accent td:first-child {
            background: var(--jazer-purple);
            color: white;
            font-weight: 800;
        }

        /* Highlight Style: Warning */
        .metrics-row.style-warning {
            background: rgba(255, 136, 0, 0.15);
        }

        .metrics-row.style-warning td {
            color: var(--jazer-orange);
            border-color: var(--jazer-orange);
        }

        .metrics-row.style-warning td:first-child {
            background: var(--jazer-orange);
            color: var(--bg-dark);
            font-weight: 800;
        }

        /* Highlight Style: Minimal */
        .metrics-row.style-minimal {
            background: rgba(255, 255, 255, 0.05);
        }

        .metrics-row.style-minimal td {
            color: var(--text-light);
            border-color: var(--border-default);
        }

        .metrics-row.style-minimal td:first-child {
            background: rgba(255, 255, 255, 0.1);
            font-weight: 700;
        }

        /* Metrics Row Label Badge */
        .metrics-label {
            display: inline-flex;
            align-items: center;
            gap: 0.4rem;
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .metrics-label-icon {
            font-size: 0.9rem;
        }

        /* Cell Highlight Animation */
        .metrics-row td.highlight-pulse {
            animation: cellPulse 2s ease-in-out infinite;
        }

        @keyframes cellPulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        /* Trend Indicators */
        .trend {
            display: inline-flex;
            align-items: center;
            gap: 0.3rem;
            font-size: 0.75rem;
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            margin-left: 0.5rem;
        }

        .trend.up {
            color: #10b981;
            background: rgba(16, 185, 129, 0.15);
        }

        .trend.down {
            color: #ef4444;
            background: rgba(239, 68, 68, 0.15);
        }

        .trend.neutral {
            color: var(--text-gray);
            background: rgba(255, 255, 255, 0.1);
        }

        /* Controls Panel */
        .controls-panel {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        details {
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid var(--border-default);
            border-radius: 10px;
            overflow: hidden;
            transition: border-color 0.2s ease;
        }

        details:hover {
            border-color: rgba(6, 182, 212, 0.3);
        }

        details[open] {
            border-color: var(--jazer-cyan);
        }

        summary {
            padding: 0.875rem 1rem;
            font-family: var(--font-secondary);
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--text-light);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            user-select: none;
            transition: background 0.2s ease;
        }

        summary:hover {
            background: rgba(6, 182, 212, 0.1);
        }

        summary::after {
            content: '+';
            font-size: 1.1rem;
            color: var(--jazer-cyan);
            transition: transform 0.2s ease;
        }

        details[open] summary::after {
            content: '-';
        }

        .details-content {
            padding: 1rem;
            border-top: 1px solid var(--border-default);
        }

        /* Control Groups */
        .control-group {
            margin-bottom: 1rem;
        }

        .control-group:last-child {
            margin-bottom: 0;
        }

        .control-label {
            display: block;
            font-size: 0.7rem;
            font-family: var(--font-secondary);
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 0.5rem;
        }

        /* Select Dropdown */
        select {
            width: 100%;
            padding: 0.6rem 0.875rem;
            font-size: 0.8rem;
            font-family: var(--font-body);
            color: var(--text-light);
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid var(--border-default);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%2306b6d4' d='M6 8L2 4h8z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 0.75rem center;
        }

        select:hover {
            border-color: var(--jazer-purple);
        }

        select:focus {
            outline: none;
            border-color: var(--jazer-cyan);
            box-shadow: 0 0 12px rgba(6, 182, 212, 0.2);
        }

        select option {
            background: var(--bg-dark);
            color: var(--text-light);
        }

        /* Checkbox Toggle */
        .toggle-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.5rem 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .toggle-row:last-child {
            border-bottom: none;
        }

        .toggle-label {
            font-size: 0.8rem;
            color: var(--text-gray);
        }

        .toggle-switch {
            position: relative;
            width: 40px;
            height: 22px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 22px;
            transition: all 0.3s ease;
            border: 2px solid var(--border-default);
        }

        .toggle-slider::before {
            content: '';
            position: absolute;
            height: 14px;
            width: 14px;
            left: 2px;
            bottom: 2px;
            background: var(--text-gray);
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .toggle-switch input:checked + .toggle-slider {
            background: rgba(6, 182, 212, 0.3);
            border-color: var(--jazer-cyan);
        }

        .toggle-switch input:checked + .toggle-slider::before {
            transform: translateX(18px);
            background: var(--jazer-cyan);
            box-shadow: 0 0 8px var(--jazer-cyan);
        }

        /* Preset Buttons */
        .presets-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.5rem;
        }

        .preset-btn {
            padding: 0.6rem 0.75rem;
            font-size: 0.7rem;
            font-family: var(--font-secondary);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid var(--border-default);
            border-radius: 8px;
            color: var(--text-gray);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .preset-btn:hover {
            border-color: var(--jazer-purple);
            color: var(--jazer-purple);
            background: rgba(147, 51, 234, 0.1);
        }

        .preset-btn.active {
            border-color: var(--jazer-cyan);
            color: var(--jazer-cyan);
            background: rgba(6, 182, 212, 0.15);
            box-shadow: 0 0 12px rgba(6, 182, 212, 0.2);
        }

        /* Style Option Grid */
        .style-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.5rem;
        }

        .style-option {
            padding: 0.6rem;
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid var(--border-default);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: center;
        }

        .style-option:hover {
            border-color: var(--jazer-purple);
        }

        .style-option.active {
            border-color: var(--jazer-cyan);
            background: rgba(6, 182, 212, 0.1);
        }

        .style-option-name {
            font-size: 0.7rem;
            font-family: var(--font-secondary);
            font-weight: 600;
            color: var(--text-light);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .style-option-preview {
            height: 4px;
            border-radius: 2px;
            margin-top: 0.4rem;
        }

        .style-option[data-style="glow"] .style-option-preview {
            background: var(--jazer-cyan);
            box-shadow: 0 0 8px var(--jazer-cyan);
        }

        .style-option[data-style="gradient"] .style-option-preview {
            background: var(--gradient-primary);
        }

        .style-option[data-style="accent"] .style-option-preview {
            background: var(--jazer-purple);
        }

        .style-option[data-style="warning"] .style-option-preview {
            background: var(--jazer-orange);
        }

        .style-option[data-style="minimal"] .style-option-preview {
            background: rgba(255, 255, 255, 0.3);
        }

        /* Data Presets */
        .data-presets {
            margin-top: 1.5rem;
        }

        .data-preset-list {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .data-preset {
            padding: 0.5rem 0.875rem;
            font-size: 0.75rem;
            font-family: var(--font-secondary);
            font-weight: 600;
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid var(--border-default);
            border-radius: 20px;
            color: var(--text-gray);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .data-preset:hover {
            border-color: var(--jazer-pink);
            color: var(--jazer-pink);
        }

        .data-preset.active {
            border-color: var(--jazer-cyan);
            color: var(--jazer-cyan);
            background: rgba(6, 182, 212, 0.1);
        }

        /* Action Buttons */
        .action-buttons {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .action-btn {
            flex: 1;
            padding: 0.7rem 1rem;
            font-size: 0.75rem;
            font-family: var(--font-secondary);
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border-radius: 8px;
            border: 2px solid var(--border-default);
            background: rgba(0, 0, 0, 0.3);
            color: var(--text-gray);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .action-btn:hover {
            border-color: var(--jazer-purple);
            color: var(--jazer-purple);
        }

        .action-btn.primary {
            border-color: var(--jazer-cyan);
            color: var(--jazer-cyan);
            background: rgba(6, 182, 212, 0.1);
        }

        .action-btn.primary:hover {
            background: rgba(6, 182, 212, 0.2);
            box-shadow: 0 0 15px rgba(6, 182, 212, 0.3);
        }

        /* Status Bar */
        .status-bar {
            background: var(--bg-card);
            border: 2px solid var(--border-default);
            border-radius: 12px;
            padding: 0.875rem 1.25rem;
            margin-top: 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 0.75rem;
        }

        .status-info {
            display: flex;
            gap: 1.5rem;
            flex-wrap: wrap;
        }

        .status-item {
            display: flex;
            align-items: center;
            gap: 0.4rem;
            font-size: 0.75rem;
        }

        .status-item span:first-child {
            color: var(--text-muted);
            font-family: var(--font-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .status-item span:last-child {
            color: var(--jazer-cyan);
            font-weight: 600;
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.75rem;
            color: var(--text-gray);
        }

        .status-dot {
            width: 8px;
            height: 8px;
            background: var(--jazer-cyan);
            border-radius: 50%;
            animation: statusPulse 2s ease-in-out infinite;
        }

        @keyframes statusPulse {
            0%, 100% { opacity: 1; box-shadow: 0 0 4px var(--jazer-cyan); }
            50% { opacity: 0.5; box-shadow: 0 0 8px var(--jazer-cyan); }
        }

        /* Multiple Metrics Rows */
        .metrics-row.secondary {
            opacity: 0.85;
        }

        .metrics-row.secondary td {
            border-width: 2px;
            font-weight: 600;
        }

        /* Calculation Badge */
        .calc-badge {
            display: inline-block;
            font-size: 0.6rem;
            padding: 0.15rem 0.35rem;
            border-radius: 4px;
            background: rgba(0, 0, 0, 0.3);
            color: inherit;
            margin-left: 0.3rem;
            vertical-align: middle;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Info Tooltip */
        .info-tip {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: rgba(6, 182, 212, 0.2);
            color: var(--jazer-cyan);
            font-size: 0.65rem;
            font-weight: 700;
            cursor: help;
            margin-left: 0.5rem;
        }

        /* Responsive */
        @media (max-width: 768px) {
            body {
                padding: 1rem;
            }

            .hero {
                padding: 1.5rem 1rem;
            }

            .panel {
                padding: 1rem;
            }

            .status-bar {
                flex-direction: column;
                align-items: flex-start;
            }

            .status-info {
                width: 100%;
                justify-content: space-between;
            }

            .presets-grid,
            .style-options {
                grid-template-columns: 1fr;
            }
        }

        /* Animation for row changes */
        .metrics-table tbody {
            transition: all 0.3s ease;
        }

        .row-highlight {
            animation: rowFlash 0.5s ease;
        }

        @keyframes rowFlash {
            0% { background: rgba(6, 182, 212, 0.3); }
            100% { background: transparent; }
        }
    </style>
</head>
<body>
    <a href="index.html" class="back-button">← Back to Data Visualization</a>

    <header class="hero">
        <h1>Key Metrics Row</h1>
        <p class="hero-description">Interactive summary rows displaying totals, averages, and key calculations with customizable positioning and styling</p>
    </header>

    <div class="main-container">
        <!-- Demo Panel -->
        <div class="panel">
            <div class="panel-title">Interactive Demo</div>
            
            <div class="table-wrapper">
                <table class="metrics-table" id="metricsTable">
                    <thead>
                        <tr>
                            <th>Period</th>
                            <th>Revenue</th>
                            <th>Orders</th>
                            <th>Customers</th>
                            <th>Avg Order</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                        <!-- Rows generated by JavaScript -->
                    </tbody>
                </table>
            </div>

            <!-- Data Presets -->
            <div class="data-presets">
                <div class="panel-title">Data Scenarios</div>
                <div class="data-preset-list" id="dataPresets">
                    <button class="data-preset active" data-preset="quarterly">Quarterly Sales</button>
                    <button class="data-preset" data-preset="monthly">Monthly Traffic</button>
                    <button class="data-preset" data-preset="departments">Departments</button>
                    <button class="data-preset" data-preset="products">Product Lines</button>
                    <button class="data-preset" data-preset="regions">Regional</button>
                </div>
            </div>
        </div>

        <!-- Controls Panel -->
        <div class="panel controls-panel">
            <div class="panel-title">Configuration</div>

            <!-- Position Controls -->
            <details open>
                <summary>Row Position</summary>
                <div class="details-content">
                    <div class="control-group">
                        <label class="control-label">Metrics Row Location</label>
                        <select id="positionSelect">
                            <option value="top">Top (After Header)</option>
                            <option value="bottom" selected>Bottom (Footer)</option>
                        </select>
                    </div>
                    <div class="toggle-row">
                        <span class="toggle-label">Show Secondary Row</span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="showSecondary">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>
            </details>

            <!-- Calculation Type -->
            <details open>
                <summary>Calculation Type</summary>
                <div class="details-content">
                    <div class="control-group">
                        <label class="control-label">Primary Calculation</label>
                        <select id="calcType">
                            <option value="sum" selected>Sum (Total)</option>
                            <option value="avg">Average</option>
                            <option value="max">Maximum</option>
                            <option value="min">Minimum</option>
                            <option value="count">Count</option>
                        </select>
                    </div>
                    <div class="control-group">
                        <label class="control-label">Secondary Calculation</label>
                        <select id="secondaryCalcType">
                            <option value="avg" selected>Average</option>
                            <option value="sum">Sum (Total)</option>
                            <option value="max">Maximum</option>
                            <option value="min">Minimum</option>
                            <option value="median">Median</option>
                        </select>
                    </div>
                </div>
            </details>

            <!-- Highlight Style -->
            <details open>
                <summary>Highlight Style</summary>
                <div class="details-content">
                    <div class="style-options" id="styleOptions">
                        <div class="style-option active" data-style="glow" title="Cyan Glow">
                            <div class="style-option-name">Glow</div>
                            <div class="style-option-preview"></div>
                        </div>
                        <div class="style-option" data-style="gradient" title="Gradient">
                            <div class="style-option-name">Gradient</div>
                            <div class="style-option-preview"></div>
                        </div>
                        <div class="style-option" data-style="accent" title="Purple Accent">
                            <div class="style-option-name">Accent</div>
                            <div class="style-option-preview"></div>
                        </div>
                        <div class="style-option" data-style="warning" title="Orange Warning">
                            <div class="style-option-name">Warning</div>
                            <div class="style-option-preview"></div>
                        </div>
                        <div class="style-option" data-style="minimal" title="Minimal">
                            <div class="style-option-name">Minimal</div>
                            <div class="style-option-preview"></div>
                        </div>
                    </div>
                </div>
            </details>

            <!-- Display Options -->
            <details>
                <summary>Display Options</summary>
                <div class="details-content">
                    <div class="toggle-row">
                        <span class="toggle-label">Show Calculation Badge</span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="showBadge" checked>
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <div class="toggle-row">
                        <span class="toggle-label">Show Trend Indicators</span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="showTrends">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <div class="toggle-row">
                        <span class="toggle-label">Animate Values</span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="animateValues" checked>
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <div class="toggle-row">
                        <span class="toggle-label">Sticky Metrics Row</span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="stickyRow">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>
            </details>

            <!-- Quick Presets -->
            <details>
                <summary>Quick Presets</summary>
                <div class="details-content">
                    <div class="presets-grid" id="quickPresets">
                        <button class="preset-btn active" data-preset="default">Default</button>
                        <button class="preset-btn" data-preset="executive">Executive</button>
                        <button class="preset-btn" data-preset="analytics">Analytics</button>
                        <button class="preset-btn" data-preset="finance">Finance</button>
                    </div>
                </div>
            </details>

            <!-- Actions -->
            <div class="action-buttons">
                <button class="action-btn" id="resetBtn">Reset</button>
                <button class="action-btn primary" id="recalculateBtn">Recalculate</button>
            </div>
        </div>
    </div>

    <!-- Status Bar -->
    <footer class="status-bar">
        <div class="status-info">
            <div class="status-item">
                <span>Position:</span>
                <span id="statusPosition">Bottom</span>
            </div>
            <div class="status-item">
                <span>Calc:</span>
                <span id="statusCalc">Sum</span>
            </div>
            <div class="status-item">
                <span>Style:</span>
                <span id="statusStyle">Glow</span>
            </div>
            <div class="status-item">
                <span>Rows:</span>
                <span id="statusRows">1</span>
            </div>
        </div>
        <div class="status-indicator">
            <span class="status-dot"></span>
            <span>Metrics Ready</span>
        </div>
    </footer>

    <script>
        // State
        const state = {
            position: 'bottom',
            calcType: 'sum',
            secondaryCalcType: 'avg',
            style: 'glow',
            showSecondary: false,
            showBadge: true,
            showTrends: false,
            animateValues: true,
            stickyRow: false,
            currentDataset: 'quarterly'
        };

        // Data Sets
        const datasets = {
            quarterly: {
                headers: ['Period', 'Revenue', 'Orders', 'Customers', 'Avg Order'],
                rows: [
                    { period: 'Q1 2024', revenue: 125430, orders: 1234, customers: 856, avgOrder: 101.65 },
                    { period: 'Q2 2024', revenue: 152780, orders: 1456, customers: 1023, avgOrder: 104.93 },
                    { period: 'Q3 2024', revenue: 187920, orders: 1853, customers: 1247, avgOrder: 101.41 },
                    { period: 'Q4 2024', revenue: 234560, orders: 2145, customers: 1534, avgOrder: 109.35 }
                ],
                format: { revenue: 'currency', orders: 'number', customers: 'number', avgOrder: 'currency' }
            },
            monthly: {
                headers: ['Period', 'Visitors', 'Page Views', 'Sessions', 'Bounce Rate'],
                rows: [
                    { period: 'January', revenue: 45230, orders: 123400, customers: 34560, avgOrder: 42.3 },
                    { period: 'February', revenue: 52180, orders: 145600, customers: 41230, avgOrder: 38.7 },
                    { period: 'March', revenue: 61920, orders: 178500, customers: 52340, avgOrder: 35.2 },
                    { period: 'April', revenue: 58340, orders: 162300, customers: 48920, avgOrder: 37.8 },
                    { period: 'May', revenue: 72150, orders: 198700, customers: 61230, avgOrder: 33.1 }
                ],
                format: { revenue: 'number', orders: 'number', customers: 'number', avgOrder: 'percent' }
            },
            departments: {
                headers: ['Period', 'Budget', 'Spent', 'Headcount', 'Cost/Person'],
                rows: [
                    { period: 'Engineering', revenue: 450000, orders: 387500, customers: 45, avgOrder: 8611 },
                    { period: 'Marketing', revenue: 180000, orders: 172300, customers: 18, avgOrder: 9572 },
                    { period: 'Sales', revenue: 320000, orders: 298400, customers: 32, avgOrder: 9325 },
                    { period: 'Operations', revenue: 150000, orders: 143200, customers: 22, avgOrder: 6509 },
                    { period: 'HR', revenue: 95000, orders: 89700, customers: 8, avgOrder: 11212 }
                ],
                format: { revenue: 'currency', orders: 'currency', customers: 'number', avgOrder: 'currency' }
            },
            products: {
                headers: ['Period', 'Units Sold', 'Revenue', 'Returns', 'Net Revenue'],
                rows: [
                    { period: 'Electronics', revenue: 4523, orders: 452300, customers: 234, avgOrder: 428960 },
                    { period: 'Apparel', revenue: 8934, orders: 267450, customers: 512, avgOrder: 252120 },
                    { period: 'Home & Garden', revenue: 3421, orders: 178230, customers: 187, avgOrder: 168540 },
                    { period: 'Sports', revenue: 2876, orders: 143800, customers: 98, avgOrder: 138900 },
                    { period: 'Books', revenue: 12453, orders: 87150, customers: 324, avgOrder: 84870 }
                ],
                format: { revenue: 'number', orders: 'currency', customers: 'number', avgOrder: 'currency' }
            },
            regions: {
                headers: ['Period', 'Sales', 'Growth', 'Market Share', 'Stores'],
                rows: [
                    { period: 'North America', revenue: 2345600, orders: 12.4, customers: 34.2, avgOrder: 156 },
                    { period: 'Europe', revenue: 1876400, orders: 8.7, customers: 27.3, avgOrder: 124 },
                    { period: 'Asia Pacific', revenue: 1534200, orders: 18.2, customers: 22.4, avgOrder: 98 },
                    { period: 'Latin America', revenue: 654300, orders: 15.6, customers: 9.5, avgOrder: 45 },
                    { period: 'Middle East', revenue: 432100, orders: 21.3, customers: 6.6, avgOrder: 28 }
                ],
                format: { revenue: 'currency', orders: 'percent', customers: 'percent', avgOrder: 'number' }
            }
        };

        // DOM References
        const tableBody = document.getElementById('tableBody');
        const positionSelect = document.getElementById('positionSelect');
        const calcTypeSelect = document.getElementById('calcType');
        const secondaryCalcSelect = document.getElementById('secondaryCalcType');
        const showSecondaryToggle = document.getElementById('showSecondary');
        const showBadgeToggle = document.getElementById('showBadge');
        const showTrendsToggle = document.getElementById('showTrends');
        const animateValuesToggle = document.getElementById('animateValues');
        const stickyRowToggle = document.getElementById('stickyRow');
        const styleOptions = document.getElementById('styleOptions');
        const dataPresets = document.getElementById('dataPresets');
        const quickPresets = document.getElementById('quickPresets');
        const resetBtn = document.getElementById('resetBtn');
        const recalculateBtn = document.getElementById('recalculateBtn');

        // Status elements
        const statusPosition = document.getElementById('statusPosition');
        const statusCalc = document.getElementById('statusCalc');
        const statusStyle = document.getElementById('statusStyle');
        const statusRows = document.getElementById('statusRows');

        // Utility Functions
        function formatValue(value, format) {
            switch (format) {
                case 'currency':
                    return '$' + value.toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 });
                case 'percent':
                    return value.toFixed(1) + '%';
                case 'number':
                default:
                    return value.toLocaleString('en-US');
            }
        }

        function calculateMetric(values, type) {
            if (!values.length) return 0;
            switch (type) {
                case 'sum':
                    return values.reduce((a, b) => a + b, 0);
                case 'avg':
                    return values.reduce((a, b) => a + b, 0) / values.length;
                case 'max':
                    return Math.max(...values);
                case 'min':
                    return Math.min(...values);
                case 'count':
                    return values.length;
                case 'median':
                    const sorted = [...values].sort((a, b) => a - b);
                    const mid = Math.floor(sorted.length / 2);
                    return sorted.length % 2 ? sorted[mid] : (sorted[mid - 1] + sorted[mid]) / 2;
                default:
                    return values.reduce((a, b) => a + b, 0);
            }
        }

        function getCalcLabel(type) {
            const labels = {
                sum: 'TOTAL',
                avg: 'AVERAGE',
                max: 'MAXIMUM',
                min: 'MINIMUM',
                count: 'COUNT',
                median: 'MEDIAN'
            };
            return labels[type] || 'TOTAL';
        }

        function getCalcBadge(type) {
            const badges = {
                sum: 'SUM',
                avg: 'AVG',
                max: 'MAX',
                min: 'MIN',
                count: 'CNT',
                median: 'MED'
            };
            return badges[type] || 'SUM';
        }

        function getTrendIndicator(current, previous) {
            if (!state.showTrends) return '';
            const diff = ((current - previous) / previous * 100).toFixed(1);
            if (diff > 0) {
                return `<span class="trend up">↑ ${diff}%</span>`;
            } else if (diff < 0) {
                return `<span class="trend down">↓ ${Math.abs(diff)}%</span>`;
            }
            return `<span class="trend neutral">→ 0%</span>`;
        }

        // Render Table
        function renderTable() {
            const dataset = datasets[state.currentDataset];
            const rows = dataset.rows;
            const format = dataset.format;

            // Calculate metrics
            const revenueValues = rows.map(r => r.revenue);
            const ordersValues = rows.map(r => r.orders);
            const customersValues = rows.map(r => r.customers);
            const avgOrderValues = rows.map(r => r.avgOrder);

            const primaryMetrics = {
                revenue: calculateMetric(revenueValues, state.calcType),
                orders: calculateMetric(ordersValues, state.calcType),
                customers: calculateMetric(customersValues, state.calcType),
                avgOrder: calculateMetric(avgOrderValues, state.calcType === 'sum' ? 'avg' : state.calcType)
            };

            const secondaryMetrics = {
                revenue: calculateMetric(revenueValues, state.secondaryCalcType),
                orders: calculateMetric(ordersValues, state.secondaryCalcType),
                customers: calculateMetric(customersValues, state.secondaryCalcType),
                avgOrder: calculateMetric(avgOrderValues, state.secondaryCalcType)
            };

            // Build metrics row HTML
            const positionClass = state.position === 'top' ? 'position-top' : 'position-bottom';
            const styleClass = `style-${state.style}`;
            const stickyClass = state.stickyRow ? 'sticky-metrics' : '';
            const badge = state.showBadge ? `<span class="calc-badge">${getCalcBadge(state.calcType)}</span>` : '';
            const secondaryBadge = state.showBadge ? `<span class="calc-badge">${getCalcBadge(state.secondaryCalcType)}</span>` : '';

            const primaryRow = `
                <tr class="metrics-row ${positionClass} ${styleClass} ${stickyClass}">
                    <td><span class="metrics-label"><span class="metrics-label-icon">Σ</span> ${getCalcLabel(state.calcType)}</span></td>
                    <td class="numeric">${formatValue(primaryMetrics.revenue, format.revenue)}${badge}${getTrendIndicator(primaryMetrics.revenue, revenueValues[0])}</td>
                    <td class="numeric">${formatValue(primaryMetrics.orders, format.orders)}${badge}</td>
                    <td class="numeric">${formatValue(primaryMetrics.customers, format.customers)}${badge}</td>
                    <td class="numeric">${formatValue(primaryMetrics.avgOrder, format.avgOrder)}${badge}</td>
                </tr>
            `;

            const secondaryRow = state.showSecondary ? `
                <tr class="metrics-row secondary ${positionClass} ${styleClass}">
                    <td><span class="metrics-label"><span class="metrics-label-icon">μ</span> ${getCalcLabel(state.secondaryCalcType)}</span></td>
                    <td class="numeric">${formatValue(secondaryMetrics.revenue, format.revenue)}${secondaryBadge}</td>
                    <td class="numeric">${formatValue(secondaryMetrics.orders, format.orders)}${secondaryBadge}</td>
                    <td class="numeric">${formatValue(secondaryMetrics.customers, format.customers)}${secondaryBadge}</td>
                    <td class="numeric">${formatValue(secondaryMetrics.avgOrder, format.avgOrder)}${secondaryBadge}</td>
                </tr>
            ` : '';

            // Build data rows
            const dataRows = rows.map((row, index) => `
                <tr data-index="${index}">
                    <td>${row.period}</td>
                    <td class="numeric">${formatValue(row.revenue, format.revenue)}</td>
                    <td class="numeric">${formatValue(row.orders, format.orders)}</td>
                    <td class="numeric">${formatValue(row.customers, format.customers)}</td>
                    <td class="numeric">${formatValue(row.avgOrder, format.avgOrder)}</td>
                </tr>
            `).join('');

            // Assemble table body based on position
            if (state.position === 'top') {
                tableBody.innerHTML = primaryRow + secondaryRow + dataRows;
            } else {
                tableBody.innerHTML = dataRows + secondaryRow + primaryRow;
            }

            // Update headers
            const headerRow = document.querySelector('.metrics-table thead tr');
            headerRow.innerHTML = dataset.headers.map(h => `<th>${h}</th>`).join('');

            // Animate if enabled
            if (state.animateValues) {
                const metricsRows = document.querySelectorAll('.metrics-row');
                metricsRows.forEach(row => {
                    row.classList.add('row-highlight');
                    setTimeout(() => row.classList.remove('row-highlight'), 500);
                });
            }

            // Update sticky style
            updateStickyStyle();
            updateStatus();
        }

        function updateStickyStyle() {
            const style = document.getElementById('stickyStyle');
            if (style) style.remove();

            if (state.stickyRow) {
                const newStyle = document.createElement('style');
                newStyle.id = 'stickyStyle';
                if (state.position === 'top') {
                    newStyle.textContent = `
                        .metrics-row.sticky-metrics {
                            position: sticky;
                            top: 40px;
                            z-index: 5;
                        }
                    `;
                } else {
                    newStyle.textContent = `
                        .metrics-row.sticky-metrics {
                            position: sticky;
                            bottom: 0;
                            z-index: 5;
                        }
                    `;
                }
                document.head.appendChild(newStyle);
            }
        }

        function updateStatus() {
            statusPosition.textContent = state.position === 'top' ? 'Top' : 'Bottom';
            statusCalc.textContent = getCalcLabel(state.calcType);
            statusStyle.textContent = state.style.charAt(0).toUpperCase() + state.style.slice(1);
            statusRows.textContent = state.showSecondary ? '2' : '1';
        }

        function setActiveClass(container, selector, activeElement) {
            container.querySelectorAll(selector).forEach(el => el.classList.remove('active'));
            activeElement.classList.add('active');
        }

        function applyPreset(preset) {
            switch (preset) {
                case 'default':
                    state.position = 'bottom';
                    state.calcType = 'sum';
                    state.style = 'glow';
                    state.showSecondary = false;
                    state.showBadge = true;
                    state.showTrends = false;
                    break;
                case 'executive':
                    state.position = 'top';
                    state.calcType = 'sum';
                    state.style = 'gradient';
                    state.showSecondary = true;
                    state.secondaryCalcType = 'avg';
                    state.showBadge = true;
                    state.showTrends = true;
                    break;
                case 'analytics':
                    state.position = 'bottom';
                    state.calcType = 'avg';
                    state.style = 'accent';
                    state.showSecondary = true;
                    state.secondaryCalcType = 'median';
                    state.showBadge = true;
                    state.showTrends = true;
                    break;
                case 'finance':
                    state.position = 'bottom';
                    state.calcType = 'sum';
                    state.style = 'minimal';
                    state.showSecondary = true;
                    state.secondaryCalcType = 'avg';
                    state.showBadge = true;
                    state.showTrends = false;
                    break;
            }
            syncControlsToState();
            renderTable();
        }

        function syncControlsToState() {
            positionSelect.value = state.position;
            calcTypeSelect.value = state.calcType;
            secondaryCalcSelect.value = state.secondaryCalcType;
            showSecondaryToggle.checked = state.showSecondary;
            showBadgeToggle.checked = state.showBadge;
            showTrendsToggle.checked = state.showTrends;
            animateValuesToggle.checked = state.animateValues;
            stickyRowToggle.checked = state.stickyRow;

            // Update style options
            styleOptions.querySelectorAll('.style-option').forEach(opt => {
                opt.classList.toggle('active', opt.dataset.style === state.style);
            });
        }

        // Event Listeners
        positionSelect.addEventListener('change', (e) => {
            state.position = e.target.value;
            renderTable();
        });

        calcTypeSelect.addEventListener('change', (e) => {
            state.calcType = e.target.value;
            renderTable();
        });

        secondaryCalcSelect.addEventListener('change', (e) => {
            state.secondaryCalcType = e.target.value;
            renderTable();
        });

        showSecondaryToggle.addEventListener('change', (e) => {
            state.showSecondary = e.target.checked;
            renderTable();
        });

        showBadgeToggle.addEventListener('change', (e) => {
            state.showBadge = e.target.checked;
            renderTable();
        });

        showTrendsToggle.addEventListener('change', (e) => {
            state.showTrends = e.target.checked;
            renderTable();
        });

        animateValuesToggle.addEventListener('change', (e) => {
            state.animateValues = e.target.checked;
        });

        stickyRowToggle.addEventListener('change', (e) => {
            state.stickyRow = e.target.checked;
            renderTable();
        });

        styleOptions.addEventListener('click', (e) => {
            const option = e.target.closest('.style-option');
            if (!option) return;
            state.style = option.dataset.style;
            setActiveClass(styleOptions, '.style-option', option);
            renderTable();
        });

        dataPresets.addEventListener('click', (e) => {
            const preset = e.target.closest('.data-preset');
            if (!preset) return;
            state.currentDataset = preset.dataset.preset;
            setActiveClass(dataPresets, '.data-preset', preset);
            renderTable();
        });

        quickPresets.addEventListener('click', (e) => {
            const preset = e.target.closest('.preset-btn');
            if (!preset) return;
            setActiveClass(quickPresets, '.preset-btn', preset);
            applyPreset(preset.dataset.preset);
        });

        resetBtn.addEventListener('click', () => {
            state.position = 'bottom';
            state.calcType = 'sum';
            state.secondaryCalcType = 'avg';
            state.style = 'glow';
            state.showSecondary = false;
            state.showBadge = true;
            state.showTrends = false;
            state.animateValues = true;
            state.stickyRow = false;
            state.currentDataset = 'quarterly';

            syncControlsToState();
            setActiveClass(dataPresets, '.data-preset', dataPresets.querySelector('[data-preset="quarterly"]'));
            setActiveClass(quickPresets, '.preset-btn', quickPresets.querySelector('[data-preset="default"]'));
            renderTable();
        });

        recalculateBtn.addEventListener('click', () => {
            // Trigger recalculation with animation
            const originalAnimate = state.animateValues;
            state.animateValues = true;
            renderTable();
            state.animateValues = originalAnimate;
        });

        // Initialize
        renderTable();
    </script>
</body>
</html>
